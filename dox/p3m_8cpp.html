<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESPResSo: p3m.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo
   </div>
   <div id="projectbrief">Extensible Simulation Package for Research on Soft Matter Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('p3m_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">p3m.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="p3m_8hpp_source.html">electrostatics_magnetostatics/p3m.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="common_8hpp_source.html">electrostatics_magnetostatics/common.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="coulomb_8hpp_source.html">electrostatics_magnetostatics/coulomb.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="elc_8hpp_source.html">electrostatics_magnetostatics/elc.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p3m__influence__function_8hpp_source.html">electrostatics_magnetostatics/p3m_influence_function.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Particle_8hpp_source.html">Particle.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ParticleRange_8hpp_source.html">ParticleRange.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cells_8hpp_source.html">cells.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="communication_8hpp_source.html">communication.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="errorhandling_8hpp_source.html">errorhandling.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fft_8hpp_source.html">fft.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="grid_8hpp_source.html">grid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate_8hpp_source.html">integrate.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tuning_8hpp_source.html">tuning.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p3m__gpu__error_8hpp_source.html">p3m_gpu_error.hpp</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="Span_8hpp_source.html">utils/Span.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="Vector_8hpp_source.html">utils/Vector.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="constants_8hpp_source.html">utils/constants.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="integral__parameter_8hpp_source.html">utils/integral_parameter.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="int__pow_8hpp_source.html">utils/math/int_pow.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sinc_8hpp_source.html">utils/math/sinc.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sqr_8hpp_source.html">utils/math/sqr.hpp</a>&gt;</code><br />
<code>#include &lt;boost/mpi/collectives/all_reduce.hpp&gt;</code><br />
<code>#include &lt;boost/mpi/collectives/reduce.hpp&gt;</code><br />
<code>#include &lt;boost/mpi/communicator.hpp&gt;</code><br />
<code>#include &lt;boost/optional.hpp&gt;</code><br />
<code>#include &lt;boost/range/algorithm/min_element.hpp&gt;</code><br />
<code>#include &lt;boost/range/numeric.hpp&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;array&gt;</code><br />
<code>#include &lt;cassert&gt;</code><br />
<code>#include &lt;complex&gt;</code><br />
<code>#include &lt;cstddef&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for p3m.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="p3m_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="p3m_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceanonymous__namespace_02p3m_8cpp_03"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02p3m_8cpp_03.html">anonymous_namespace{p3m.cpp}</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6a51dba3d397f3cac288917294d1e8f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a6a51dba3d397f3cac288917294d1e8f6">p3m_init</a> ()</td></tr>
<tr class="memdesc:a6a51dba3d397f3cac288917294d1e8f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize all structures, parameters and arrays needed for the P3M algorithm for charge-charge interactions.  <a href="p3m_8cpp.html#a6a51dba3d397f3cac288917294d1e8f6">More...</a><br /></td></tr>
<tr class="separator:a6a51dba3d397f3cac288917294d1e8f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ffd5dee4673329073feceb45c40cf8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a4ffd5dee4673329073feceb45c40cf8e">p3m_set_tune_params</a> (double r_cut, const int mesh[3], int cao, double accuracy)</td></tr>
<tr class="memdesc:a4ffd5dee4673329073feceb45c40cf8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set initial values for <a class="el" href="p3m_8hpp.html#ae37be878423a80cc74fcd806e456e35d" title="Tune P3M parameters to desired accuracy.">p3m_adaptive_tune()</a>  <a href="p3m_8cpp.html#a4ffd5dee4673329073feceb45c40cf8e">More...</a><br /></td></tr>
<tr class="separator:a4ffd5dee4673329073feceb45c40cf8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62973bfeb3a1fcf7e5d1362eed4f8680"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a62973bfeb3a1fcf7e5d1362eed4f8680">p3m_set_params</a> (double r_cut, const int *mesh, int cao, double alpha, double accuracy)</td></tr>
<tr class="memdesc:a62973bfeb3a1fcf7e5d1362eed4f8680"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set custom parameters.  <a href="p3m_8cpp.html#a62973bfeb3a1fcf7e5d1362eed4f8680">More...</a><br /></td></tr>
<tr class="separator:a62973bfeb3a1fcf7e5d1362eed4f8680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78fc0741febd3045a9ec029a128a22d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a78fc0741febd3045a9ec029a128a22d7">p3m_set_mesh_offset</a> (double x, double y, double z)</td></tr>
<tr class="memdesc:a78fc0741febd3045a9ec029a128a22d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set mesh offset.  <a href="p3m_8cpp.html#a78fc0741febd3045a9ec029a128a22d7">More...</a><br /></td></tr>
<tr class="separator:a78fc0741febd3045a9ec029a128a22d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34d47800b518270919812fa3e513df33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a34d47800b518270919812fa3e513df33">p3m_set_eps</a> (double eps)</td></tr>
<tr class="memdesc:a34d47800b518270919812fa3e513df33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set <a class="el" href="structP3MParameters.html#ae85b071ed00fbffbaf298a4a33a75aea">epsilon</a> parameter.  <a href="p3m_8cpp.html#a34d47800b518270919812fa3e513df33">More...</a><br /></td></tr>
<tr class="separator:a34d47800b518270919812fa3e513df33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab318acdae52332dac7c7dc9ff87ebe67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#ab318acdae52332dac7c7dc9ff87ebe67">p3m_charge_assign</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:ab318acdae52332dac7c7dc9ff87ebe67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign the physical charges using the tabulated charge assignment function.  <a href="p3m_8cpp.html#ab318acdae52332dac7c7dc9ff87ebe67">More...</a><br /></td></tr>
<tr class="separator:ab318acdae52332dac7c7dc9ff87ebe67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa74e5c32018f31475dc197c0b7ddf164"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#aa74e5c32018f31475dc197c0b7ddf164">p3m_assign_charge</a> (double q, const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;real_pos, <a class="el" href="classp3m__interpolation__cache.html">p3m_interpolation_cache</a> &amp;inter_weights)</td></tr>
<tr class="memdesc:aa74e5c32018f31475dc197c0b7ddf164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign a single charge into the current charge grid.  <a href="p3m_8cpp.html#aa74e5c32018f31475dc197c0b7ddf164">More...</a><br /></td></tr>
<tr class="separator:aa74e5c32018f31475dc197c0b7ddf164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac25ca5acdc264b9ec9c0da823370978f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#ac25ca5acdc264b9ec9c0da823370978f">p3m_assign_charge</a> (double q, const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;real_pos)</td></tr>
<tr class="memdesc:ac25ca5acdc264b9ec9c0da823370978f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is an overloaded member function, provided for convenience. It differs from the above function only in what argument(s) it accepts.  <a href="p3m_8cpp.html#ac25ca5acdc264b9ec9c0da823370978f">More...</a><br /></td></tr>
<tr class="separator:ac25ca5acdc264b9ec9c0da823370978f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49dbca112bf02b685b5a5e2adc942042"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02p3m_8cpp_03.html#a49dbca112bf02b685b5a5e2adc942042">anonymous_namespace{p3m.cpp}::dipole_moment</a> (<a class="el" href="structParticle.html">Particle</a> const &amp;p, <a class="el" href="classBoxGeometry.html">BoxGeometry</a> const &amp;box)</td></tr>
<tr class="separator:a49dbca112bf02b685b5a5e2adc942042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1646e7ed9a26dfbbc533c3e4f1faed0"><td class="memItemLeft" align="right" valign="top">auto&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02p3m_8cpp_03.html#af1646e7ed9a26dfbbc533c3e4f1faed0">anonymous_namespace{p3m.cpp}::calc_dipole_moment</a> (boost::mpi::communicator const &amp;comm, const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles, <a class="el" href="classBoxGeometry.html">BoxGeometry</a> const &amp;box)</td></tr>
<tr class="separator:af1646e7ed9a26dfbbc533c3e4f1faed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb96a4491d648065209ec4bfa837eb4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02p3m_8cpp_03.html#acb96a4491d648065209ec4bfa837eb4d">anonymous_namespace{p3m.cpp}::add_dipole_correction</a> (<a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> const &amp;box_dipole, const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="separator:acb96a4491d648065209ec4bfa837eb4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1ef08e4a46a510aef35874ca20aca6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02p3m_8cpp_03.html#a1c1ef08e4a46a510aef35874ca20aca6">anonymous_namespace{p3m.cpp}::dipole_correction_energy</a> (<a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> const &amp;box_dipole)</td></tr>
<tr class="separator:a1c1ef08e4a46a510aef35874ca20aca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32ba0a9281a258e7d8c2847862446bf3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceUtils.html#a7c823b9fc7a7170c2e506150f62b0839">Utils::Vector9d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a32ba0a9281a258e7d8c2847862446bf3">p3m_calc_kspace_pressure_tensor</a> ()</td></tr>
<tr class="memdesc:a32ba0a9281a258e7d8c2847862446bf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the k-space part of the pressure tensor.  <a href="p3m_8cpp.html#a32ba0a9281a258e7d8c2847862446bf3">More...</a><br /></td></tr>
<tr class="separator:a32ba0a9281a258e7d8c2847862446bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae42b24a2f0264f79f05e7f78d1a31807"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#ae42b24a2f0264f79f05e7f78d1a31807">p3m_calc_kspace_forces</a> (bool force_flag, bool energy_flag, const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:ae42b24a2f0264f79f05e7f78d1a31807"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the k-space part of forces and energies for the charge-charge interaction.  <a href="p3m_8cpp.html#ae42b24a2f0264f79f05e7f78d1a31807">More...</a><br /></td></tr>
<tr class="separator:ae42b24a2f0264f79f05e7f78d1a31807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb801268d83020ea71a09f8a79df784"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#aceb801268d83020ea71a09f8a79df784">p3m_get_accuracy</a> (const int mesh[3], int cao, double r_cut_iL, double *_alpha_L, double *_rs_err, double *_ks_err)</td></tr>
<tr class="memdesc:aceb801268d83020ea71a09f8a79df784"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the minimal error for this combination of parameters.  <a href="p3m_8cpp.html#aceb801268d83020ea71a09f8a79df784">More...</a><br /></td></tr>
<tr class="separator:aceb801268d83020ea71a09f8a79df784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a262ef397e04ced0c4f0ad4dfbb9535c0"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a262ef397e04ced0c4f0ad4dfbb9535c0">p3m_mcr_time</a> (const int mesh[3], int cao, double r_cut_iL, double alpha_L, int timings)</td></tr>
<tr class="memdesc:a262ef397e04ced0c4f0ad4dfbb9535c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the computation time for some <code>mesh</code>, <code>cao</code>, <code>r_cut</code> and <code>alpha</code>.  <a href="p3m_8cpp.html#a262ef397e04ced0c4f0ad4dfbb9535c0">More...</a><br /></td></tr>
<tr class="separator:a262ef397e04ced0c4f0ad4dfbb9535c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801f4b39979ce3cde5ac5a177cc77b99"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a801f4b39979ce3cde5ac5a177cc77b99">p3m_mc_time</a> (const int mesh[3], int cao, double r_cut_iL_min, double r_cut_iL_max, double *_r_cut_iL, double *_alpha_L, double *_accuracy, int timings, bool verbose)</td></tr>
<tr class="memdesc:a801f4b39979ce3cde5ac5a177cc77b99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code> and <code>cao</code>.  <a href="p3m_8cpp.html#a801f4b39979ce3cde5ac5a177cc77b99">More...</a><br /></td></tr>
<tr class="separator:a801f4b39979ce3cde5ac5a177cc77b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af435b5794ab2fb85d8f2a917e5229ec0"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#af435b5794ab2fb85d8f2a917e5229ec0">p3m_m_time</a> (const int mesh[3], int cao_min, int cao_max, int *_cao, double r_cut_iL_min, double r_cut_iL_max, double *_r_cut_iL, double *_alpha_L, double *_accuracy, int timings, bool verbose)</td></tr>
<tr class="memdesc:af435b5794ab2fb85d8f2a917e5229ec0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code>.  <a href="p3m_8cpp.html#af435b5794ab2fb85d8f2a917e5229ec0">More...</a><br /></td></tr>
<tr class="separator:af435b5794ab2fb85d8f2a917e5229ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae37be878423a80cc74fcd806e456e35d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#ae37be878423a80cc74fcd806e456e35d">p3m_adaptive_tune</a> (int timings, bool verbose)</td></tr>
<tr class="memdesc:ae37be878423a80cc74fcd806e456e35d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tune P3M parameters to desired accuracy.  <a href="p3m_8cpp.html#ae37be878423a80cc74fcd806e456e35d">More...</a><br /></td></tr>
<tr class="separator:ae37be878423a80cc74fcd806e456e35d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04a9dbb99b609ec1e181fba9d575e87e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a04a9dbb99b609ec1e181fba9d575e87e">p3m_count_charged_particles</a> ()</td></tr>
<tr class="memdesc:a04a9dbb99b609ec1e181fba9d575e87e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate number of charged particles, the sum of the squared charges and the squared sum of the charges.  <a href="p3m_8cpp.html#a04a9dbb99b609ec1e181fba9d575e87e">More...</a><br /></td></tr>
<tr class="separator:a04a9dbb99b609ec1e181fba9d575e87e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23994b7b72ebfbc8d0c462dd7fd3de90"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a23994b7b72ebfbc8d0c462dd7fd3de90">p3m_sanity_checks</a> ()</td></tr>
<tr class="memdesc:a23994b7b72ebfbc8d0c462dd7fd3de90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sanity checks.  <a href="p3m_8cpp.html#a23994b7b72ebfbc8d0c462dd7fd3de90">More...</a><br /></td></tr>
<tr class="separator:a23994b7b72ebfbc8d0c462dd7fd3de90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62205d2240d2597ce49b96d7429d3594"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a62205d2240d2597ce49b96d7429d3594">p3m_scaleby_box_l</a> ()</td></tr>
<tr class="memdesc:a62205d2240d2597ce49b96d7429d3594"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update <a class="el" href="structP3MParameters.html#a3584ba7cf5a189c6c98814b1aead35d1">alpha</a> and <a class="el" href="structP3MParameters.html#ac409ec47f19086dfba16ed7dffec48e5">r_cut</a> if box length changed.  <a href="p3m_8cpp.html#a62205d2240d2597ce49b96d7429d3594">More...</a><br /></td></tr>
<tr class="separator:a62205d2240d2597ce49b96d7429d3594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Private Functions</div></td></tr>
<tr class="memitem:ab6b6b12679852714784c5b169b9293ea"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#ab6b6b12679852714784c5b169b9293ea">p3m_init_a_ai_cao_cut</a> ()</td></tr>
<tr class="memdesc:ab6b6b12679852714784c5b169b9293ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the (inverse) mesh constant <a class="el" href="structP3MParameters.html#a3c5bbb63a4216b12ab7d5b4b1c150bfc">a</a> (<a class="el" href="structP3MParameters.html#ac3e474b0410cfdb96c7da77988c870bc">ai</a>) and the cutoff for charge assignment <a class="el" href="structP3MParameters.html#aa36a1725f1bd8665655f375ac49b6bed">cao_cut</a>.  <a href="p3m_8cpp.html#ab6b6b12679852714784c5b169b9293ea">More...</a><br /></td></tr>
<tr class="separator:ab6b6b12679852714784c5b169b9293ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a546699f736121853d21e5d512681f3db"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a546699f736121853d21e5d512681f3db">p3m_sanity_checks_system</a> (const <a class="el" href="namespaceUtils.html#a40cbc808d5e70b8c462dd45854942e5c">Utils::Vector3i</a> &amp;grid)</td></tr>
<tr class="memdesc:a546699f736121853d21e5d512681f3db"><td class="mdescLeft">&#160;</td><td class="mdescRight">General sanity checks independent of p3m parameters.  <a href="p3m_8cpp.html#a546699f736121853d21e5d512681f3db">More...</a><br /></td></tr>
<tr class="separator:a546699f736121853d21e5d512681f3db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9475ee80a9cd4864fa449772bdb2c99"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#ae9475ee80a9cd4864fa449772bdb2c99">p3m_sanity_checks_boxl</a> ()</td></tr>
<tr class="memdesc:ae9475ee80a9cd4864fa449772bdb2c99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks for correctness for charges in P3M of the cao_cut, necessary when the box length changes.  <a href="p3m_8cpp.html#ae9475ee80a9cd4864fa449772bdb2c99">More...</a><br /></td></tr>
<tr class="separator:ae9475ee80a9cd4864fa449772bdb2c99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18f450c45561e4d1904670896eb0fe42"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a18f450c45561e4d1904670896eb0fe42">p3m_sanity_checks_parameters</a> ()</td></tr>
<tr class="memdesc:a18f450c45561e4d1904670896eb0fe42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks that necessary parameters are set.  <a href="p3m_8cpp.html#a18f450c45561e4d1904670896eb0fe42">More...</a><br /></td></tr>
<tr class="separator:a18f450c45561e4d1904670896eb0fe42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a9b9b8a3920c6bc0c7e6d72d9a6ab6f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a2a9b9b8a3920c6bc0c7e6d72d9a6ab6f">p3m_calc_influence_function_force</a> ()</td></tr>
<tr class="memdesc:a2a9b9b8a3920c6bc0c7e6d72d9a6ab6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the optimal influence function of <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a>.  <a href="p3m_8cpp.html#a2a9b9b8a3920c6bc0c7e6d72d9a6ab6f">More...</a><br /></td></tr>
<tr class="separator:a2a9b9b8a3920c6bc0c7e6d72d9a6ab6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5540644d719d5e6f81874d7c0e28b9b7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a5540644d719d5e6f81874d7c0e28b9b7">p3m_calc_influence_function_energy</a> ()</td></tr>
<tr class="memdesc:a5540644d719d5e6f81874d7c0e28b9b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the influence function optimized for the energy and the self energy correction.  <a href="p3m_8cpp.html#a5540644d719d5e6f81874d7c0e28b9b7">More...</a><br /></td></tr>
<tr class="separator:a5540644d719d5e6f81874d7c0e28b9b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">P3M tuning helper functions</div></td></tr>
<tr class="memitem:a6f2c956d55eee05e6c5234ad269b1a89"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a6f2c956d55eee05e6c5234ad269b1a89">p3m_real_space_error</a> (double prefac, double r_cut_iL, int n_c_part, double sum_q2, double alpha_L)</td></tr>
<tr class="memdesc:a6f2c956d55eee05e6c5234ad269b1a89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the real space contribution to the rms error in the force (as described by Kolafa and Perram).  <a href="p3m_8cpp.html#a6f2c956d55eee05e6c5234ad269b1a89">More...</a><br /></td></tr>
<tr class="separator:a6f2c956d55eee05e6c5234ad269b1a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fda68f92a160053a73a1aad0b4fb2af"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a6fda68f92a160053a73a1aad0b4fb2af">p3m_k_space_error</a> (double prefac, const int mesh[3], int cao, int n_c_part, double sum_q2, double alpha_L)</td></tr>
<tr class="memdesc:a6fda68f92a160053a73a1aad0b4fb2af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the analytic expression of the error estimate for the P3M method in <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a> (eq.  <a href="p3m_8cpp.html#a6fda68f92a160053a73a1aad0b4fb2af">More...</a><br /></td></tr>
<tr class="separator:a6fda68f92a160053a73a1aad0b4fb2af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af032d6847fcb043e141479813a01f72e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#af032d6847fcb043e141479813a01f72e">p3m_tune_aliasing_sums</a> (int nx, int ny, int nz, const int mesh[3], const double mesh_i[3], int cao, double alpha_L_i, double *alias1, double *alias2)</td></tr>
<tr class="memdesc:af032d6847fcb043e141479813a01f72e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aliasing sum used by <a class="el" href="p3m_8cpp.html#a6fda68f92a160053a73a1aad0b4fb2af">p3m_k_space_error</a>.  <a href="p3m_8cpp.html#af032d6847fcb043e141479813a01f72e">More...</a><br /></td></tr>
<tr class="separator:af032d6847fcb043e141479813a01f72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7aa93f83f07b2a73588aa2ed986b19b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structp3m__data__struct.html">p3m_data_struct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m_8cpp.html#a7aa93f83f07b2a73588aa2ed986b19b6">p3m</a></td></tr>
<tr class="memdesc:a7aa93f83f07b2a73588aa2ed986b19b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">P3M parameters.  <a href="p3m_8cpp.html#a7aa93f83f07b2a73588aa2ed986b19b6">More...</a><br /></td></tr>
<tr class="separator:a7aa93f83f07b2a73588aa2ed986b19b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The corresponding header file is <a class="el" href="p3m_8hpp.html">p3m.hpp</a>. </p>

<p class="definition">Definition in file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae37be878423a80cc74fcd806e456e35d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae37be878423a80cc74fcd806e456e35d">&#9670;&nbsp;</a></span>p3m_adaptive_tune()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int p3m_adaptive_tune </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tune P3M parameters to desired accuracy. </p>
<p>The parameters <a class="el" href="structP3MParameters.html#a7cc8344779c25939a75d7363a2ef0645">mesh</a>, <a class="el" href="structP3MParameters.html#a578a99326ade4c2b93287d6be4527996">cao</a>, <a class="el" href="structP3MParameters.html#a54ee4a4b7a374690203f6d1e641b3457">r_cut_iL</a> and <a class="el" href="structP3MParameters.html#a66edee020fd1dc6497d35b764bfd2938">alpha_L</a> are tuned to obtain the target accuracy (initially stored in <a class="el" href="structP3MParameters.html#a5b85854a94374889d5758e3efdb9886a">accuracy</a>) in optimal time. These parameters are stored in the <a class="el" href="p3m_8hpp.html#a7aa93f83f07b2a73588aa2ed986b19b6">p3m</a> object.</p>
<p>The function utilizes the analytic expression of the error estimate for the P3M method in <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a> (eq. (8.23)) in order to obtain the rms error in the force for a system of N randomly distributed particles in a cubic box. For the real space error the estimate of Kolafa/Perram is used.</p>
<p>Parameter ranges if not given explicit values via <a class="el" href="p3m_8hpp.html#a4ffd5dee4673329073feceb45c40cf8e" title="Set initial values for p3m_adaptive_tune()">p3m_set_tune_params()</a>:</p><ul>
<li><code>mesh</code> is set up such that the number of mesh points is equal to the number of charged particles</li>
<li><code>cao</code> explores all possible values</li>
<li><code>alpha_L</code> is tuned for each tuple (<code>r_cut_iL</code>, <code>mesh</code>, <code>cao</code>) and calculated assuming that the error contributions of real and reciprocal space should be equal</li>
</ul>
<p>After checking if the total error lies below the target accuracy, the time needed for one force calculation (including Verlet list update) is measured via <a class="el" href="tuning_8cpp.html#a1966673e670f08cb1c1ee4ea4428d37c" title="Measure the time for some force calculations.">time_force_calc()</a>.</p>
<p>The function generates a log of the performed tuning.</p>
<p>The function is based on routines of the program HE_Q.cpp written by M. Deserno.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timings</td><td>Number of test force calculations </td></tr>
    <tr><td class="paramname">verbose</td><td>printf output </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ES_OK</td><td></td></tr>
    <tr><td class="paramname">ES_ERROR</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00954">954</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="coulomb_8hpp_source.html#l00038">COULOMB_P3M</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="constants_8hpp_source.html#l00080">ES_ERROR</a>, <a class="el" href="constants_8hpp_source.html#l00078">ES_OK</a>, <a class="el" href="LocalBox_8hpp_source.html#l00044">LocalBox&lt; T &gt;::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="coulomb_8hpp_source.html#l00056">Coulomb_parameters::method</a>, <a class="el" href="Correlator_8cpp_source.html#l00048">anonymous_namespace{Correlator.cpp}::min()</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="communication_8hpp_source.html#l00106">mpi_call_all()</a>, <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m_8cpp_source.html#l01157">p3m_count_charged_particles()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00074">P3M_EPSILON_METALLIC</a>, <a class="el" href="p3m_8cpp_source.html#l00821">p3m_m_time()</a>, <a class="el" href="p3m_8cpp_source.html#l01282">p3m_sanity_checks_system()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00079">P3M_TIME_GRAN</a>, <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="coulomb_8hpp_source.html#l00050">Coulomb_parameters::prefactor</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>, <a class="el" href="integrate_8cpp_source.html#l00077">skin</a>, <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>, <a class="el" href="p3m_8hpp_source.html#l00072">p3m_data_struct::sum_qpart</a>, <a class="el" href="p3m-common_8hpp_source.html#l00116">P3MParameters::tuning</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

</div>
</div>
<a id="ac25ca5acdc264b9ec9c0da823370978f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac25ca5acdc264b9ec9c0da823370978f">&#9670;&nbsp;</a></span>p3m_assign_charge() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_assign_charge </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;&#160;</td>
          <td class="paramname"><em>real_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is an overloaded member function, provided for convenience. It differs from the above function only in what argument(s) it accepts. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00346">346</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00140">P3MParameters::ai</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

</div>
</div>
<a id="aa74e5c32018f31475dc197c0b7ddf164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa74e5c32018f31475dc197c0b7ddf164">&#9670;&nbsp;</a></span>p3m_assign_charge() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_assign_charge </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;&#160;</td>
          <td class="paramname"><em>real_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classp3m__interpolation__cache.html">p3m_interpolation_cache</a> &amp;&#160;</td>
          <td class="paramname"><em>inter_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign a single charge into the current charge grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Particle charge </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">real_pos</td><td>Particle position in real space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inter_weights</td><td>Cached interpolation weights to be used. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00339">339</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00140">P3MParameters::ai</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

<p class="reference">Referenced by <a class="el" href="elc_8cpp_source.html#l01153">anonymous_namespace{elc.cpp}::assign_image_charge()</a>, and <a class="el" href="elc_8cpp_source.html#l01171">ELC_p3m_charge_assign_both()</a>.</p>

</div>
</div>
<a id="a5540644d719d5e6f81874d7c0e28b9b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5540644d719d5e6f81874d7c0e28b9b7">&#9670;&nbsp;</a></span>p3m_calc_influence_function_energy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_calc_influence_function_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the influence function optimized for the energy and the self energy correction. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00591">591</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m_8hpp_source.html#l00083">p3m_data_struct::fft</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00042">p3m_data_struct_base::g_energy</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, and <a class="el" href="fft_8hpp_source.html#l00110">fft_forw_plan::start</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l01345">p3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="a2a9b9b8a3920c6bc0c7e6d72d9a6ab6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a9b9b8a3920c6bc0c7e6d72d9a6ab6f">&#9670;&nbsp;</a></span>p3m_calc_influence_function_force()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_calc_influence_function_force </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the optimal influence function of <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a>. </p>
<p>(optimised for force calculations)</p>
<p>Each node calculates only the values for its domain in k-space (see fft.plan[3].mesh and fft.plan[3].start).</p>
<p>See also: <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a> eq. 8-22 (p. 275). Note the somewhat different convention for the prefactors, which is described in <a class="el" href="citelist.html#CITEREF_deserno98a">[11]</a> <a class="el" href="citelist.html#CITEREF_deserno98b">[12]</a>. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00583">583</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m_8hpp_source.html#l00083">p3m_data_struct::fft</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00040">p3m_data_struct_base::g_force</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, and <a class="el" href="fft_8hpp_source.html#l00110">fft_forw_plan::start</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l01345">p3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="ae42b24a2f0264f79f05e7f78d1a31807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae42b24a2f0264f79f05e7f78d1a31807">&#9670;&nbsp;</a></span>p3m_calc_kspace_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double p3m_calc_kspace_forces </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>energy_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the k-space part of forces and energies for the charge-charge interaction. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00481">481</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m_8cpp_source.html#l00396">anonymous_namespace{p3m.cpp}::add_dipole_correction()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m_8cpp_source.html#l00385">anonymous_namespace{p3m.cpp}::calc_dipole_moment()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00038">p3m_data_struct_base::d_op</a>, <a class="el" href="p3m-common_8hpp_source.html#l00091">P3MLocalMesh::dim</a>, <a class="el" href="p3m_8cpp_source.html#l00408">anonymous_namespace{p3m.cpp}::dipole_correction_energy()</a>, <a class="el" href="p3m_8hpp_source.html#l00069">p3m_data_struct::E_mesh</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="p3m_8hpp_source.html#l00083">p3m_data_struct::fft</a>, <a class="el" href="fft_8cpp_source.html#l00715">fft_perform_back()</a>, <a class="el" href="fft_8cpp_source.html#l00684">fft_perform_forw()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00042">p3m_data_struct_base::g_energy</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00040">p3m_data_struct_base::g_force</a>, <a class="el" href="p3m__send__mesh_8cpp_source.html#l00111">p3m_send_mesh::gather_grid()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00045">p3m_data_struct_base::ks_pnum</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="Span_8hpp_source.html#l00116">Utils::make_span()</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="fft_8hpp_source.html#l00112">fft_forw_plan::new_size</a>, <a class="el" href="Variant_8hpp_source.html#l00059">ScriptInterface::none</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00074">P3M_EPSILON_METALLIC</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, <a class="el" href="coulomb_8hpp_source.html#l00050">Coulomb_parameters::prefactor</a>, <a class="el" href="p3m_8hpp_source.html#l00067">p3m_data_struct::rs_mesh</a>, <a class="el" href="p3m_8hpp_source.html#l00081">p3m_data_struct::sm</a>, <a class="el" href="p3m__send__mesh_8cpp_source.html#l00149">p3m_send_mesh::spread_grid()</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="constants_8hpp_source.html#l00043">Utils::sqrt_pi_i()</a>, <a class="el" href="p3m_8hpp_source.html#l00076">p3m_data_struct::square_sum_q</a>, <a class="el" href="fft_8hpp_source.html#l00110">fft_forw_plan::start</a>, <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>, <a class="el" href="communication_8cpp_source.html#l00062">this_node</a>, <a class="el" href="p3m-common_8hpp_source.html#l00116">P3MParameters::tuning</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="a32ba0a9281a258e7d8c2847862446bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32ba0a9281a258e7d8c2847862446bf3">&#9670;&nbsp;</a></span>p3m_calc_kspace_pressure_tensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceUtils.html#a7c823b9fc7a7170c2e506150f62b0839">Utils::Vector9d</a> p3m_calc_kspace_pressure_tensor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the k-space part of the pressure tensor. </p>
<p>Calculate the long range electrostatics part of the pressure tensor. This is part \(\Pi_{\textrm{dir}, \alpha, \beta}\) eq. (2.6) in <a class="el" href="citelist.html#CITEREF_essmann95a">[21]</a>. The part \(\Pi_{\textrm{corr}, \alpha, \beta}\) eq. (2.8) is not present here since M is the empty set in our simulations. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00421">421</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="p3m-common_8hpp_source.html#l00091">P3MLocalMesh::dim</a>, <a class="el" href="p3m_8hpp_source.html#l00083">p3m_data_struct::fft</a>, <a class="el" href="fft_8cpp_source.html#l00684">fft_perform_forw()</a>, <a class="el" href="p3m__send__mesh_8cpp_source.html#l00111">p3m_send_mesh::gather_grid()</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, <a class="el" href="p3m_8hpp_source.html#l00067">p3m_data_struct::rs_mesh</a>, <a class="el" href="p3m_8hpp_source.html#l00081">p3m_data_struct::sm</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, and <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00058">Coulomb::calc_pressure_long_range()</a>.</p>

</div>
</div>
<a id="ab318acdae52332dac7c7dc9ff87ebe67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab318acdae52332dac7c7dc9ff87ebe67">&#9670;&nbsp;</a></span>p3m_charge_assign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_charge_assign </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign the physical charges using the tabulated charge assignment function. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00329">329</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m_8hpp_source.html#l00078">p3m_data_struct::inter_weights</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="p3m__interpolation_8hpp_source.html#l00125">p3m_interpolation_cache::reset()</a>, <a class="el" href="p3m_8hpp_source.html#l00067">p3m_data_struct::rs_mesh</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00093">P3MLocalMesh::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>, <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00058">Coulomb::calc_pressure_long_range()</a>.</p>

</div>
</div>
<a id="a04a9dbb99b609ec1e181fba9d575e87e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a9dbb99b609ec1e181fba9d575e87e">&#9670;&nbsp;</a></span>p3m_count_charged_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_count_charged_particles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate number of charged particles, the sum of the squared charges and the squared sum of the charges. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01157">1157</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="cells_8cpp_source.html#l00052">cell_structure</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="CellStructure_8cpp_source.html#l00193">CellStructure::local_particles()</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="p3m_8hpp_source.html#l00076">p3m_data_struct::square_sum_q</a>, <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>, and <a class="el" href="p3m_8hpp_source.html#l00072">p3m_data_struct::sum_qpart</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00165">on_observable_calc()</a>, <a class="el" href="p3m_8cpp_source.html#l00954">p3m_adaptive_tune()</a>, and <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>.</p>

</div>
</div>
<a id="aceb801268d83020ea71a09f8a79df784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceb801268d83020ea71a09f8a79df784">&#9670;&nbsp;</a></span>p3m_get_accuracy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double p3m_get_accuracy </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mesh</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_rs_err</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_ks_err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the minimal error for this combination of parameters. </p>
<p>The real space error is tuned such that it contributes half of the total error, and then the Fourier space error is calculated. If an optimal alpha is not found, the value 0.1 is used as fallback. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_rs_err</td><td>real space error </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_ks_err</td><td>Fourier space error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error magnitude </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00612">612</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="coulomb_8hpp_source.html#l00039">COULOMB_P3M_GPU</a>, <a class="el" href="Array_8hpp_source.html#l00098">Utils::Array&lt; T, N &gt;::data()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="coulomb_8hpp_source.html#l00056">Coulomb_parameters::method</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m_8cpp_source.html#l01185">p3m_k_space_error()</a>, <a class="el" href="p3m__gpu__error__cuda_8cu_source.html#l00317">p3m_k_space_error_gpu()</a>, <a class="el" href="p3m_8cpp_source.html#l01178">p3m_real_space_error()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="coulomb_8hpp_source.html#l00050">Coulomb_parameters::prefactor</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>, <a class="el" href="constants_8hpp_source.html#l00064">Utils::sqrt_2()</a>, <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>, and <a class="el" href="p3m_8hpp_source.html#l00072">p3m_data_struct::sum_qpart</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00709">p3m_mc_time()</a>.</p>

</div>
</div>
<a id="a6a51dba3d397f3cac288917294d1e8f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a51dba3d397f3cac288917294d1e8f6">&#9670;&nbsp;</a></span>p3m_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize all structures, parameters and arrays needed for the P3M algorithm for charge-charge interactions. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00167">167</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-data__struct_8hpp_source.html#l00051">p3m_data_struct_base::calc_differential_operator()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-common_8hpp_source.html#l00149">P3MParameters::cao3</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="coulomb_8hpp_source.html#l00040">COULOMB_ELC_P3M</a>, <a class="el" href="p3m-common_8hpp_source.html#l00091">P3MLocalMesh::dim</a>, <a class="el" href="p3m_8hpp_source.html#l00069">p3m_data_struct::E_mesh</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="p3m_8hpp_source.html#l00083">p3m_data_struct::fft</a>, <a class="el" href="fft_8cpp_source.html#l00485">fft_init()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00045">p3m_data_struct_base::ks_pnum</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="p3m-common_8hpp_source.html#l00106">P3MLocalMesh::margin</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m-common_8hpp_source.html#l00127">P3MParameters::mesh_off</a>, <a class="el" href="coulomb_8hpp_source.html#l00056">Coulomb_parameters::method</a>, <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-common_8cpp_source.html#l00116">p3m_calc_local_ca_mesh()</a>, <a class="el" href="p3m_8cpp_source.html#l01157">p3m_count_charged_particles()</a>, <a class="el" href="p3m_8cpp_source.html#l01248">p3m_init_a_ai_cao_cut()</a>, <a class="el" href="p3m_8cpp_source.html#l01330">p3m_sanity_checks()</a>, <a class="el" href="p3m_8cpp_source.html#l01312">p3m_sanity_checks_parameters()</a>, <a class="el" href="p3m_8cpp_source.html#l01345">p3m_scaleby_box_l()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="coulomb_8hpp_source.html#l00050">Coulomb_parameters::prefactor</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, <a class="el" href="p3m__send__mesh_8cpp_source.html#l00036">p3m_send_mesh::resize()</a>, <a class="el" href="p3m_8hpp_source.html#l00067">p3m_data_struct::rs_mesh</a>, <a class="el" href="integrate_8cpp_source.html#l00077">skin</a>, <a class="el" href="p3m_8hpp_source.html#l00081">p3m_data_struct::sm</a>, and <a class="el" href="elc_8hpp_source.html#l00089">ELCParameters::space_layer</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00234">Coulomb::init()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00179">on_coulomb_change()</a>.</p>

</div>
</div>
<a id="ab6b6b12679852714784c5b169b9293ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6b6b12679852714784c5b169b9293ea">&#9670;&nbsp;</a></span>p3m_init_a_ai_cao_cut()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_init_a_ai_cao_cut </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the (inverse) mesh constant <a class="el" href="structP3MParameters.html#a3c5bbb63a4216b12ab7d5b4b1c150bfc">a</a> (<a class="el" href="structP3MParameters.html#ac3e474b0410cfdb96c7da77988c870bc">ai</a>) and the cutoff for charge assignment <a class="el" href="structP3MParameters.html#aa36a1725f1bd8665655f375ac49b6bed">cao_cut</a>. </p>
<p>Function called by <a class="el" href="p3m_8cpp.html#a6a51dba3d397f3cac288917294d1e8f6">p3m_init()</a> once and by <a class="el" href="p3m_8cpp.html#a62205d2240d2597ce49b96d7429d3594">p3m_scaleby_box_l()</a> whenever the box length changes. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01248">1248</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00138">P3MParameters::a</a>, <a class="el" href="p3m-common_8hpp_source.html#l00140">P3MParameters::ai</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-common_8hpp_source.html#l00136">P3MParameters::cao_cut</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>, and <a class="el" href="p3m_8cpp_source.html#l01345">p3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="a6fda68f92a160053a73a1aad0b4fb2af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fda68f92a160053a73a1aad0b4fb2af">&#9670;&nbsp;</a></span>p3m_k_space_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double p3m_k_space_error </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prefac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mesh</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_c_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sum_q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the analytic expression of the error estimate for the P3M method in <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a> (eq. </p>
<p>8-23 p. 275) in order to obtain the rms error in the force for a system of N randomly distributed particles in a cubic box (k-space part). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prefac</td><td>Prefactor of <a class="el" href="namespaceCoulomb.html">Coulomb</a> interaction. </td></tr>
    <tr><td class="paramname">mesh</td><td>number of mesh points in one direction. </td></tr>
    <tr><td class="paramname">cao</td><td>charge assignment order. </td></tr>
    <tr><td class="paramname">n_c_part</td><td>number of charged particles in the system. </td></tr>
    <tr><td class="paramname">sum_q2</td><td>sum of square of charges in the system </td></tr>
    <tr><td class="paramname">alpha_L</td><td>rescaled Ewald splitting parameter. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>reciprocal (k) space error </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01185">1185</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="p3m-common_8cpp_source.html#l00063">p3m_analytic_cotangent_sum()</a>, <a class="el" href="p3m_8cpp_source.html#l01218">p3m_tune_aliasing_sums()</a>, <a class="el" href="config_8hpp_source.html#l00073">ROUND_ERROR_PREC</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, and <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00612">p3m_get_accuracy()</a>.</p>

</div>
</div>
<a id="af435b5794ab2fb85d8f2a917e5229ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af435b5794ab2fb85d8f2a917e5229ec0">&#9670;&nbsp;</a></span>p3m_m_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double p3m_m_time </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mesh</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>_cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code>. </p>
<p><code>_cao</code> should contain an initial guess, which is then adapted by stepping up and down.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao_min</td><td>lower bound for <code>_cao</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao_max</td><td>upper bound for <code>_cao</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">_cao</td><td>initial guess for the charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_min</td><td>lower bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_max</td><td>upper bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_accuracy</td><td>accuracy of the actual parameter set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timings</td><td>Number of test force calculations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>printf output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integration time in case of success, otherwise -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8">P3M_TUNE_FAIL</a> or -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a46906b66a49469b01be67b3a6a5ddcb7">P3M_TUNE_CAO_TOO_LARGE</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00821">821</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m_8cpp_source.html#l00709">p3m_mc_time()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00079">P3M_TIME_GRAN</a>, <a class="el" href="p3m-common_8hpp_source.html#l00054">P3M_TUNE_CAO_TOO_LARGE</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00954">p3m_adaptive_tune()</a>.</p>

</div>
</div>
<a id="a801f4b39979ce3cde5ac5a177cc77b99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a801f4b39979ce3cde5ac5a177cc77b99">&#9670;&nbsp;</a></span>p3m_mc_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double p3m_mc_time </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mesh</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code> and <code>cao</code>. </p>
<p>The <code>_r_cut_iL</code> is determined via a simple bisection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_min</td><td>lower bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_max</td><td>upper bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_accuracy</td><td>accuracy of the actual parameter set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timings</td><td>Number of test force calculations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>printf output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integration time in case of success, otherwise -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8">P3M_TUNE_FAIL</a>, -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a060f6731104fa7a5d35e33030498fce6">P3M_TUNE_ACCURACY_TOO_LARGE</a>, -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a46906b66a49469b01be67b3a6a5ddcb7">P3M_TUNE_CAO_TOO_LARGE</a>, or -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a9cf881fe29103872b8dad34bcf3b5692">P3M_TUNE_ELCTEST</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00709">709</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="coulomb_8hpp_source.html#l00040">COULOMB_ELC_P3M</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="elc_8hpp_source.html#l00058">ELCParameters::gap_size</a>, <a class="el" href="LocalBox_8hpp_source.html#l00044">LocalBox&lt; T &gt;::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="coulomb_8hpp_source.html#l00056">Coulomb_parameters::method</a>, <a class="el" href="Correlator_8cpp_source.html#l00048">anonymous_namespace{Correlator.cpp}::min()</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m_8cpp_source.html#l00612">p3m_get_accuracy()</a>, <a class="el" href="p3m_8cpp_source.html#l00663">p3m_mcr_time()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00077">P3M_RCUT_PREC</a>, <a class="el" href="p3m-common_8hpp_source.html#l00059">P3M_TUNE_ACCURACY_TOO_LARGE</a>, <a class="el" href="p3m-common_8hpp_source.html#l00054">P3M_TUNE_CAO_TOO_LARGE</a>, <a class="el" href="p3m-common_8hpp_source.html#l00056">P3M_TUNE_ELCTEST</a>, <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, and <a class="el" href="integrate_8cpp_source.html#l00077">skin</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00821">p3m_m_time()</a>.</p>

</div>
</div>
<a id="a262ef397e04ced0c4f0ad4dfbb9535c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a262ef397e04ced0c4f0ad4dfbb9535c0">&#9670;&nbsp;</a></span>p3m_mcr_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double p3m_mcr_time </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mesh</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the computation time for some <code>mesh</code>, <code>cao</code>, <code>r_cut</code> and <code>alpha</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timings</td><td>Number of test force calculations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integration time in case of success, otherwise -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8">P3M_TUNE_FAIL</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00663">663</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="coulomb_8hpp_source.html#l00040">COULOMB_ELC_P3M</a>, <a class="el" href="coulomb_8hpp_source.html#l00038">COULOMB_P3M</a>, <a class="el" href="coulomb_8hpp_source.html#l00039">COULOMB_P3M_GPU</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="coulomb_8hpp_source.html#l00056">Coulomb_parameters::method</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, and <a class="el" href="tuning_8cpp_source.html#l00042">time_force_calc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00709">p3m_mc_time()</a>.</p>

</div>
</div>
<a id="a6f2c956d55eee05e6c5234ad269b1a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f2c956d55eee05e6c5234ad269b1a89">&#9670;&nbsp;</a></span>p3m_real_space_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double p3m_real_space_error </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prefac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_c_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sum_q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the real space contribution to the rms error in the force (as described by Kolafa and Perram). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prefac</td><td>Prefactor of <a class="el" href="namespaceCoulomb.html">Coulomb</a> interaction. </td></tr>
    <tr><td class="paramname">r_cut_iL</td><td>rescaled real space cutoff for p3m method. </td></tr>
    <tr><td class="paramname">n_c_part</td><td>number of charged particles in the system. </td></tr>
    <tr><td class="paramname">sum_q2</td><td>sum of square of charges in the system </td></tr>
    <tr><td class="paramname">alpha_L</td><td>rescaled Ewald splitting parameter. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>real space error </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01178">1178</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00612">p3m_get_accuracy()</a>.</p>

</div>
</div>
<a id="a23994b7b72ebfbc8d0c462dd7fd3de90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23994b7b72ebfbc8d0c462dd7fd3de90">&#9670;&nbsp;</a></span>p3m_sanity_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool p3m_sanity_checks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sanity checks. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01330">1330</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>, <a class="el" href="p3m_8cpp_source.html#l01256">p3m_sanity_checks_boxl()</a>, <a class="el" href="p3m_8cpp_source.html#l01312">p3m_sanity_checks_parameters()</a>, and <a class="el" href="p3m_8cpp_source.html#l01282">p3m_sanity_checks_system()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00087">Coulomb::sanity_checks()</a>.</p>

</div>
</div>
<a id="ae9475ee80a9cd4864fa449772bdb2c99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9475ee80a9cd4864fa449772bdb2c99">&#9670;&nbsp;</a></span>p3m_sanity_checks_boxl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool p3m_sanity_checks_boxl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks for correctness for charges in P3M of the cao_cut, necessary when the box length changes. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01256">1256</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00136">P3MParameters::cao_cut</a>, <a class="el" href="LocalBox_8hpp_source.html#l00044">LocalBox&lt; T &gt;::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00118">BoxGeometry::length_half()</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l01330">p3m_sanity_checks()</a>, and <a class="el" href="p3m_8cpp_source.html#l01345">p3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="a18f450c45561e4d1904670896eb0fe42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18f450c45561e4d1904670896eb0fe42">&#9670;&nbsp;</a></span>p3m_sanity_checks_parameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool p3m_sanity_checks_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks that necessary parameters are set. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01312">1312</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>, and <a class="el" href="p3m_8cpp_source.html#l01330">p3m_sanity_checks()</a>.</p>

</div>
</div>
<a id="a546699f736121853d21e5d512681f3db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a546699f736121853d21e5d512681f3db">&#9670;&nbsp;</a></span>p3m_sanity_checks_system()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool p3m_sanity_checks_system </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceUtils.html#a40cbc808d5e70b8c462dd45854942e5c">Utils::Vector3i</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>General sanity checks independent of p3m parameters. </p>
<dl class="section return"><dt>Returns</dt><dd>false if ok, true on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01282">1282</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="cells_8cpp_source.html#l00052">cell_structure</a>, <a class="el" href="CellStructure_8hpp_source.html#l00052">CELL_STRUCTURE_DOMDEC</a>, <a class="el" href="CellStructure_8hpp_source.html#l00247">CellStructure::decomposition_type()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00074">P3M_EPSILON_METALLIC</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00097">BoxGeometry::periodic()</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00954">p3m_adaptive_tune()</a>, and <a class="el" href="p3m_8cpp_source.html#l01330">p3m_sanity_checks()</a>.</p>

</div>
</div>
<a id="a62205d2240d2597ce49b96d7429d3594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62205d2240d2597ce49b96d7429d3594">&#9670;&nbsp;</a></span>p3m_scaleby_box_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_scaleby_box_l </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update <a class="el" href="structP3MParameters.html#a3584ba7cf5a189c6c98814b1aead35d1">alpha</a> and <a class="el" href="structP3MParameters.html#ac409ec47f19086dfba16ed7dffec48e5">r_cut</a> if box length changed. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01345">1345</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m_8cpp_source.html#l00591">p3m_calc_influence_function_energy()</a>, <a class="el" href="p3m_8cpp_source.html#l00583">p3m_calc_influence_function_force()</a>, <a class="el" href="p3m-common_8cpp_source.html#l00193">p3m_calc_lm_ld_pos()</a>, <a class="el" href="p3m_8cpp_source.html#l01248">p3m_init_a_ai_cao_cut()</a>, <a class="el" href="p3m_8cpp_source.html#l01256">p3m_sanity_checks_boxl()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="coulomb_8hpp_source.html#l00050">Coulomb_parameters::prefactor</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00210">Coulomb::on_boxl_change()</a>, and <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>.</p>

</div>
</div>
<a id="a34d47800b518270919812fa3e513df33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34d47800b518270919812fa3e513df33">&#9670;&nbsp;</a></span>p3m_set_eps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_set_eps </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set <a class="el" href="structP3MParameters.html#ae85b071ed00fbffbaf298a4a33a75aea">epsilon</a> parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">eps</td><td>epsilon of the "surrounding dielectric". </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00290">290</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

</div>
</div>
<a id="a78fc0741febd3045a9ec029a128a22d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78fc0741febd3045a9ec029a128a22d7">&#9670;&nbsp;</a></span>p3m_set_mesh_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_set_mesh_offset </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set mesh offset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x,y,z</td><td>Components of <a class="el" href="structP3MParameters.html#a70b180e29a641c610519136db4c2dc16">mesh_off</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00276">276</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00127">P3MParameters::mesh_off</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

</div>
</div>
<a id="a62973bfeb3a1fcf7e5d1362eed4f8680"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62973bfeb3a1fcf7e5d1362eed4f8680">&#9670;&nbsp;</a></span>p3m_set_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_set_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set custom parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut</td><td>unscaled <a class="el" href="structP3MParameters.html#a54ee4a4b7a374690203f6d1e641b3457">r_cut_iL</a> for use with fast inline functions only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>unscaled <a class="el" href="structP3MParameters.html#a66edee020fd1dc6497d35b764bfd2938">alpha_L</a> for use with fast inline functions only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">accuracy</td><td>accuracy of the actual parameter set. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00239">239</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="coulomb_8hpp_source.html#l00040">COULOMB_ELC_P3M</a>, <a class="el" href="coulomb_8hpp_source.html#l00038">COULOMB_P3M</a>, <a class="el" href="coulomb_8hpp_source.html#l00039">COULOMB_P3M_GPU</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="coulomb_8hpp_source.html#l00056">Coulomb_parameters::method</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>.</p>

</div>
</div>
<a id="a4ffd5dee4673329073feceb45c40cf8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ffd5dee4673329073feceb45c40cf8e">&#9670;&nbsp;</a></span>p3m_set_tune_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_set_tune_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mesh</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set initial values for <a class="el" href="p3m_8hpp.html#ae37be878423a80cc74fcd806e456e35d" title="Tune P3M parameters to desired accuracy.">p3m_adaptive_tune()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut</td><td>unscaled <a class="el" href="structP3MParameters.html#a54ee4a4b7a374690203f6d1e641b3457">r_cut_iL</a> for use with fast inline functions only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">accuracy</td><td>accuracy of the actual parameter set. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00216">216</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>.</p>

</div>
</div>
<a id="af032d6847fcb043e141479813a01f72e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af032d6847fcb043e141479813a01f72e">&#9670;&nbsp;</a></span>p3m_tune_aliasing_sums()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_tune_aliasing_sums </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mesh</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>mesh_i</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>alias1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>alias2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Aliasing sum used by <a class="el" href="p3m_8cpp.html#a6fda68f92a160053a73a1aad0b4fb2af">p3m_k_space_error</a>. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l01218">1218</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">References <a class="el" href="config_8hpp_source.html#l00053">P3M_BRILLOUIN</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="sinc_8hpp_source.html#l00045">Utils::sinc()</a>, and <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l01185">p3m_k_space_error()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7aa93f83f07b2a73588aa2ed986b19b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa93f83f07b2a73588aa2ed986b19b6">&#9670;&nbsp;</a></span>p3m</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structp3m__data__struct.html">p3m_data_struct</a> p3m</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>P3M parameters. </p>

<p class="definition">Definition at line <a class="el" href="p3m_8cpp_source.html#l00074">74</a> of file <a class="el" href="p3m_8cpp_source.html">p3m.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m_8cpp_source.html#l00396">anonymous_namespace{p3m.cpp}::add_dipole_correction()</a>, <a class="el" href="coulomb_8cpp_source.html#l00400">Coulomb::bcast_coulomb_params()</a>, <a class="el" href="coulomb_8cpp_source.html#l00113">Coulomb::cutoff()</a>, <a class="el" href="p3m_8cpp_source.html#l00408">anonymous_namespace{p3m.cpp}::dipole_correction_energy()</a>, <a class="el" href="elc_8cpp_source.html#l01040">ELC_init()</a>, <a class="el" href="elc_8cpp_source.html#l01171">ELC_p3m_charge_assign_both()</a>, <a class="el" href="elc_8cpp_source.html#l01186">ELC_p3m_charge_assign_image()</a>, <a class="el" href="elc_8cpp_source.html#l01277">ELC_P3M_modify_p3m_sums_both()</a>, <a class="el" href="elc_8cpp_source.html#l01313">ELC_P3M_modify_p3m_sums_image()</a>, <a class="el" href="elc_8cpp_source.html#l01347">ELC_P3M_restore_p3m_sums()</a>, <a class="el" href="elc_8cpp_source.html#l01009">ELC_sanity_checks()</a>, <a class="el" href="elc_8cpp_source.html#l01079">ELC_set_params()</a>, <a class="el" href="coulomb_8cpp_source.html#l00179">on_coulomb_change()</a>, <a class="el" href="p3m_8cpp_source.html#l00954">p3m_adaptive_tune()</a>, <a class="el" href="p3m_8hpp_source.html#l00171">p3m_add_pair_force()</a>, <a class="el" href="p3m_8cpp_source.html#l00339">p3m_assign_charge()</a>, <a class="el" href="p3m_8cpp_source.html#l00591">p3m_calc_influence_function_energy()</a>, <a class="el" href="p3m_8cpp_source.html#l00583">p3m_calc_influence_function_force()</a>, <a class="el" href="p3m_8cpp_source.html#l00481">p3m_calc_kspace_forces()</a>, <a class="el" href="p3m_8cpp_source.html#l00421">p3m_calc_kspace_pressure_tensor()</a>, <a class="el" href="p3m_8cpp_source.html#l00329">p3m_charge_assign()</a>, <a class="el" href="p3m_8cpp_source.html#l01157">p3m_count_charged_particles()</a>, <a class="el" href="p3m_8cpp_source.html#l00612">p3m_get_accuracy()</a>, <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>, <a class="el" href="p3m_8cpp_source.html#l01248">p3m_init_a_ai_cao_cut()</a>, <a class="el" href="p3m_8cpp_source.html#l00709">p3m_mc_time()</a>, <a class="el" href="p3m_8cpp_source.html#l00663">p3m_mcr_time()</a>, <a class="el" href="p3m_8hpp_source.html#l00231">p3m_pair_energy()</a>, <a class="el" href="p3m_8cpp_source.html#l01256">p3m_sanity_checks_boxl()</a>, <a class="el" href="p3m_8cpp_source.html#l01312">p3m_sanity_checks_parameters()</a>, <a class="el" href="p3m_8cpp_source.html#l01282">p3m_sanity_checks_system()</a>, <a class="el" href="p3m_8cpp_source.html#l01345">p3m_scaleby_box_l()</a>, <a class="el" href="p3m_8cpp_source.html#l00290">p3m_set_eps()</a>, <a class="el" href="p3m_8cpp_source.html#l00276">p3m_set_mesh_offset()</a>, <a class="el" href="p3m_8cpp_source.html#l00239">p3m_set_params()</a>, and <a class="el" href="p3m_8cpp_source.html#l00216">p3m_set_tune_params()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_6b7c06b7a7a76c60d0c114007966a512.html">electrostatics_magnetostatics</a></li><li class="navelem"><a class="el" href="p3m_8cpp.html">p3m.cpp</a></li>
    <li class="footer">Generated on Tue Aug 31 2021 01:35:09 for ESPResSo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
