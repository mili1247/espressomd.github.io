<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESPResSo: p3m-common.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo
   </div>
   <div id="projectbrief">Extensible Simulation Package for Research on Soft Matter Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('p3m-common_8hpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">p3m-common.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="config_8hpp_source.html">config.hpp</a>&quot;</code><br />
<code>#include &lt;array&gt;</code><br />
<code>#include &lt;cstddef&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &quot;<a class="el" href="LocalBox_8hpp_source.html">LocalBox.hpp</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="Vector_8hpp_source.html">utils/Vector.hpp</a>&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for p3m-common.hpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="p3m-common_8hpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="p3m-common_8hpp__dep__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="p3m-common_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structP3MLocalMesh.html">P3MLocalMesh</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for local mesh parameters.  <a href="structP3MLocalMesh.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structP3MParameters.html">P3MParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure to hold P3M parameters and some dependent variables.  <a href="structP3MParameters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a139efd3ffd3bcb2d2db84aa1727e40f0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#a139efd3ffd3bcb2d2db84aa1727e40f0">P3M_EPSILON_METALLIC</a>&#160;&#160;&#160;0.0</td></tr>
<tr class="memdesc:a139efd3ffd3bcb2d2db84aa1727e40f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This value indicates metallic boundary conditions.  <a href="p3m-common_8hpp.html#a139efd3ffd3bcb2d2db84aa1727e40f0">More...</a><br /></td></tr>
<tr class="separator:a139efd3ffd3bcb2d2db84aa1727e40f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab6454d44518f32a0366f90ce86cc73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#a3ab6454d44518f32a0366f90ce86cc73">P3M_RCUT_PREC</a>&#160;&#160;&#160;1e-3</td></tr>
<tr class="memdesc:a3ab6454d44518f32a0366f90ce86cc73"><td class="mdescLeft">&#160;</td><td class="mdescRight">precision limit for the r_cut zero  <a href="p3m-common_8hpp.html#a3ab6454d44518f32a0366f90ce86cc73">More...</a><br /></td></tr>
<tr class="separator:a3ab6454d44518f32a0366f90ce86cc73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada81b7c3cdcc5b90b7478f208396d031"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#ada81b7c3cdcc5b90b7478f208396d031">P3M_TIME_GRAN</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ada81b7c3cdcc5b90b7478f208396d031"><td class="mdescLeft">&#160;</td><td class="mdescRight">granularity of the time measurement  <a href="p3m-common_8hpp.html#ada81b7c3cdcc5b90b7478f208396d031">More...</a><br /></td></tr>
<tr class="separator:ada81b7c3cdcc5b90b7478f208396d031"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ab0d016305579047d33306fe0fb12a389"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389">P3M_TUNE_ERROR</a> { <br />
&#160;&#160;<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8">P3M_TUNE_FAIL</a> = 1, 
<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a0f406adef2a0ea54b9cfd08768ab209c">P3M_TUNE_NOCUTOFF</a> = 2, 
<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a46906b66a49469b01be67b3a6a5ddcb7">P3M_TUNE_CAO_TOO_LARGE</a> = 4, 
<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a9cf881fe29103872b8dad34bcf3b5692">P3M_TUNE_ELCTEST</a> = 8, 
<br />
&#160;&#160;<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389aeb760b434a9b7fb53fce091e018030d6">P3M_TUNE_CUTOFF_TOO_LARGE</a> = 16, 
<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a060f6731104fa7a5d35e33030498fce6">P3M_TUNE_ACCURACY_TOO_LARGE</a> = 32
<br />
 }</td></tr>
<tr class="memdesc:ab0d016305579047d33306fe0fb12a389"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error Codes for p3m tuning (version 2)  <a href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389">More...</a><br /></td></tr>
<tr class="separator:ab0d016305579047d33306fe0fb12a389"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a96990ecdc3d6e8184962b670b5138acc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#a96990ecdc3d6e8184962b670b5138acc">p3m_add_block</a> (double const *in, double *out, int const start[3], int const size[3], int const dim[3])</td></tr>
<tr class="memdesc:a96990ecdc3d6e8184962b670b5138acc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add values of a 3d-grid input block (size[3]) to values of 3d-grid output array with dimension dim[3] at start position start[3].  <a href="p3m-common_8hpp.html#a96990ecdc3d6e8184962b670b5138acc">More...</a><br /></td></tr>
<tr class="separator:a96990ecdc3d6e8184962b670b5138acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a478f79993fbc160f393764dd9e7fddba"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#a478f79993fbc160f393764dd9e7fddba">p3m_analytic_cotangent_sum</a> (int n, double mesh_i, int cao)</td></tr>
<tr class="memdesc:a478f79993fbc160f393764dd9e7fddba"><td class="mdescLeft">&#160;</td><td class="mdescRight">One of the aliasing sums used by <a class="el" href="p3m_8cpp.html#a6fda68f92a160053a73a1aad0b4fb2af">p3m_k_space_error</a>.  <a href="p3m-common_8hpp.html#a478f79993fbc160f393764dd9e7fddba">More...</a><br /></td></tr>
<tr class="separator:a478f79993fbc160f393764dd9e7fddba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9217a451326479cd6128ab04b30dbfed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#a9217a451326479cd6128ab04b30dbfed">p3m_calc_local_ca_mesh</a> (<a class="el" href="structP3MLocalMesh.html">P3MLocalMesh</a> &amp;local_mesh, const <a class="el" href="structP3MParameters.html">P3MParameters</a> &amp;<a class="el" href="steepest__descent_8cpp.html#a7c810f3a2b554c3abe0c472e66645420">params</a>, const <a class="el" href="classLocalBox.html">LocalBox</a>&lt; double &gt; &amp;<a class="el" href="grid_8hpp.html#ae795c0a2998e5336d81eb0a8c7ca2f36">local_geo</a>, double <a class="el" href="integrate_8hpp.html#a1fad9813185ba0cb89981455e59b1408">skin</a>, double space_layer)</td></tr>
<tr class="memdesc:a9217a451326479cd6128ab04b30dbfed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate properties of the local FFT mesh for the charge assignment process.  <a href="p3m-common_8hpp.html#a9217a451326479cd6128ab04b30dbfed">More...</a><br /></td></tr>
<tr class="separator:a9217a451326479cd6128ab04b30dbfed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb24aebf6e2e95b9e9bfeab236a57689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-common_8hpp.html#afb24aebf6e2e95b9e9bfeab236a57689">p3m_calc_lm_ld_pos</a> (<a class="el" href="structP3MLocalMesh.html">P3MLocalMesh</a> &amp;local_mesh, const <a class="el" href="structP3MParameters.html">P3MParameters</a> &amp;<a class="el" href="steepest__descent_8cpp.html#a7c810f3a2b554c3abe0c472e66645420">params</a>)</td></tr>
<tr class="memdesc:afb24aebf6e2e95b9e9bfeab236a57689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the spatial position of the left down mesh point of the local mesh, to be stored in <a class="el" href="structP3MLocalMesh.html#acd9e8f648e789e55e13a12c0367be12b">ld_pos</a>.  <a href="p3m-common_8hpp.html#afb24aebf6e2e95b9e9bfeab236a57689">More...</a><br /></td></tr>
<tr class="separator:afb24aebf6e2e95b9e9bfeab236a57689"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Common functions for dipolar and charge P3M.</p>
<p>We use here a P3M (Particle-Particle Particle-Mesh) method based on the Ewald summation. Details of the used method can be found in <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a> and <a class="el" href="citelist.html#CITEREF_deserno98a">[11]</a> <a class="el" href="citelist.html#CITEREF_deserno98b">[12]</a>. The file p3m contains only the Particle-Mesh part.</p>
<p>Further reading: <a class="el" href="citelist.html#CITEREF_ewald21a">[22]</a>, <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a>, <a class="el" href="citelist.html#CITEREF_deserno98a">[11]</a>, <a class="el" href="citelist.html#CITEREF_deserno98b">[12]</a>, <a class="el" href="citelist.html#CITEREF_deserno00e">[13]</a>, <a class="el" href="citelist.html#CITEREF_deserno00b">[14]</a>, <a class="el" href="citelist.html#CITEREF_cerda08d">[10]</a> </p>

<p class="definition">Definition in file <a class="el" href="p3m-common_8hpp_source.html">p3m-common.hpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a139efd3ffd3bcb2d2db84aa1727e40f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a139efd3ffd3bcb2d2db84aa1727e40f0">&#9670;&nbsp;</a></span>P3M_EPSILON_METALLIC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define P3M_EPSILON_METALLIC&#160;&#160;&#160;0.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This value indicates metallic boundary conditions. </p>

<p class="definition">Definition at line <a class="el" href="p3m-common_8hpp_source.html#l00074">74</a> of file <a class="el" href="p3m-common_8hpp_source.html">p3m-common.hpp</a>.</p>

</div>
</div>
<a id="a3ab6454d44518f32a0366f90ce86cc73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ab6454d44518f32a0366f90ce86cc73">&#9670;&nbsp;</a></span>P3M_RCUT_PREC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define P3M_RCUT_PREC&#160;&#160;&#160;1e-3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>precision limit for the r_cut zero </p>

<p class="definition">Definition at line <a class="el" href="p3m-common_8hpp_source.html#l00077">77</a> of file <a class="el" href="p3m-common_8hpp_source.html">p3m-common.hpp</a>.</p>

</div>
</div>
<a id="ada81b7c3cdcc5b90b7478f208396d031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada81b7c3cdcc5b90b7478f208396d031">&#9670;&nbsp;</a></span>P3M_TIME_GRAN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define P3M_TIME_GRAN&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>granularity of the time measurement </p>

<p class="definition">Definition at line <a class="el" href="p3m-common_8hpp_source.html#l00079">79</a> of file <a class="el" href="p3m-common_8hpp_source.html">p3m-common.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ab0d016305579047d33306fe0fb12a389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0d016305579047d33306fe0fb12a389">&#9670;&nbsp;</a></span>P3M_TUNE_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389">P3M_TUNE_ERROR</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error Codes for p3m tuning (version 2) </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8"></a>P3M_TUNE_FAIL&#160;</td><td class="fielddoc"><p>force evaluation failed </p>
</td></tr>
<tr><td class="fieldname"><a id="ab0d016305579047d33306fe0fb12a389a0f406adef2a0ea54b9cfd08768ab209c"></a>P3M_TUNE_NOCUTOFF&#160;</td><td class="fielddoc"><p>could not find a valid realspace cutoff radius </p>
</td></tr>
<tr><td class="fieldname"><a id="ab0d016305579047d33306fe0fb12a389a46906b66a49469b01be67b3a6a5ddcb7"></a>P3M_TUNE_CAO_TOO_LARGE&#160;</td><td class="fielddoc"><p>charge assignment order too large for mesh size </p>
</td></tr>
<tr><td class="fieldname"><a id="ab0d016305579047d33306fe0fb12a389a9cf881fe29103872b8dad34bcf3b5692"></a>P3M_TUNE_ELCTEST&#160;</td><td class="fielddoc"><p>conflict with ELC gap size </p>
</td></tr>
<tr><td class="fieldname"><a id="ab0d016305579047d33306fe0fb12a389aeb760b434a9b7fb53fce091e018030d6"></a>P3M_TUNE_CUTOFF_TOO_LARGE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab0d016305579047d33306fe0fb12a389a060f6731104fa7a5d35e33030498fce6"></a>P3M_TUNE_ACCURACY_TOO_LARGE&#160;</td><td class="fielddoc"><p>could not achieve target accuracy </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="p3m-common_8hpp_source.html#l00048">48</a> of file <a class="el" href="p3m-common_8hpp_source.html">p3m-common.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a96990ecdc3d6e8184962b670b5138acc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96990ecdc3d6e8184962b670b5138acc">&#9670;&nbsp;</a></span>p3m_add_block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_add_block </td>
          <td>(</td>
          <td class="paramtype">double const *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int const&#160;</td>
          <td class="paramname"><em>start</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int const&#160;</td>
          <td class="paramname"><em>size</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int const&#160;</td>
          <td class="paramname"><em>dim</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add values of a 3d-grid input block (size[3]) to values of 3d-grid output array with dimension dim[3] at start position start[3]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>Pointer to first element of input block data. </td></tr>
    <tr><td class="paramname">out</td><td>Pointer to first element of output grid. </td></tr>
    <tr><td class="paramname">start</td><td>Start position of block in output grid. </td></tr>
    <tr><td class="paramname">size</td><td>Dimensions of the block </td></tr>
    <tr><td class="paramname">dim</td><td>Dimensions of the output grid. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m-common_8cpp_source.html#l00039">39</a> of file <a class="el" href="p3m-common_8cpp_source.html">p3m-common.cpp</a>.</p>

<p class="reference">References <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00695">f</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m__send__mesh_8cpp_source.html#l00111">p3m_send_mesh::gather_grid()</a>.</p>

</div>
</div>
<a id="a478f79993fbc160f393764dd9e7fddba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a478f79993fbc160f393764dd9e7fddba">&#9670;&nbsp;</a></span>p3m_analytic_cotangent_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double p3m_analytic_cotangent_sum </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mesh_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One of the aliasing sums used by <a class="el" href="p3m_8cpp.html#a6fda68f92a160053a73a1aad0b4fb2af">p3m_k_space_error</a>. </p>
<p>Fortunately the one which is most important (because it converges most slowly, since it is not damped exponentially) can be calculated analytically. The result (which depends on the order of the spline interpolation) can be written as an even trigonometric polynomial. The results are tabulated here (the employed formula is eq. (7.66) in <a class="el" href="citelist.html#CITEREF_hockney88a">[27]</a>). </p>

<p class="definition">Definition at line <a class="el" href="p3m-common_8cpp_source.html#l00063">63</a> of file <a class="el" href="p3m-common_8cpp_source.html">p3m-common.cpp</a>.</p>

<p class="reference">References <a class="el" href="lb-d3q19_8hpp_source.html#l00038">D3Q19::c</a>, <a class="el" href="errorhandling_8cpp_source.html#l00075">errexit()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l01037">res</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, and <a class="el" href="communication_8cpp_source.html#l00062">this_node</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01249">dp3m_k_space_error()</a>, and <a class="el" href="p3m_8cpp_source.html#l01185">p3m_k_space_error()</a>.</p>

</div>
</div>
<a id="afb24aebf6e2e95b9e9bfeab236a57689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb24aebf6e2e95b9e9bfeab236a57689">&#9670;&nbsp;</a></span>p3m_calc_lm_ld_pos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_calc_lm_ld_pos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structP3MLocalMesh.html">P3MLocalMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>local_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structP3MParameters.html">P3MParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the spatial position of the left down mesh point of the local mesh, to be stored in <a class="el" href="structP3MLocalMesh.html#acd9e8f648e789e55e13a12c0367be12b">ld_pos</a>. </p>
<p>Function called by <a class="el" href="p3m-common_8cpp.html#a9217a451326479cd6128ab04b30dbfed">p3m_calc_local_ca_mesh()</a> once and by <a class="el" href="p3m_8cpp.html#a62205d2240d2597ce49b96d7429d3594">p3m_scaleby_box_l()</a> whenever the box size changes. </p>

<p class="definition">Definition at line <a class="el" href="p3m-common_8cpp_source.html#l00193">193</a> of file <a class="el" href="p3m-common_8cpp_source.html">p3m-common.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00096">P3MLocalMesh::ld_ind</a>, <a class="el" href="p3m-common_8hpp_source.html#l00098">P3MLocalMesh::ld_pos</a>, and <a class="el" href="steepest__descent_8cpp_source.html#l00044">params</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">dp3m_scaleby_box_l()</a>, and <a class="el" href="p3m_8cpp_source.html#l01345">p3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="a9217a451326479cd6128ab04b30dbfed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9217a451326479cd6128ab04b30dbfed">&#9670;&nbsp;</a></span>p3m_calc_local_ca_mesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void p3m_calc_local_ca_mesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structP3MLocalMesh.html">P3MLocalMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>local_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structP3MParameters.html">P3MParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classLocalBox.html">LocalBox</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>local_geo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>skin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>space_layer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate properties of the local FFT mesh for the charge assignment process. </p>

<p class="definition">Definition at line <a class="el" href="p3m-common_8cpp_source.html#l00116">116</a> of file <a class="el" href="p3m-common_8cpp_source.html">p3m-common.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00091">P3MLocalMesh::dim</a>, <a class="el" href="p3m-common_8hpp_source.html#l00102">P3MLocalMesh::in_ld</a>, <a class="el" href="p3m-common_8hpp_source.html#l00104">P3MLocalMesh::in_ur</a>, <a class="el" href="p3m-common_8hpp_source.html#l00100">P3MLocalMesh::inner</a>, <a class="el" href="p3m-common_8hpp_source.html#l00096">P3MLocalMesh::ld_ind</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00106">P3MLocalMesh::margin</a>, <a class="el" href="LocalBox_8hpp_source.html#l00040">LocalBox&lt; T &gt;::my_left()</a>, <a class="el" href="LocalBox_8hpp_source.html#l00042">LocalBox&lt; T &gt;::my_right()</a>, <a class="el" href="steepest__descent_8cpp_source.html#l00044">params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00112">P3MLocalMesh::q_21_off</a>, <a class="el" href="p3m-common_8hpp_source.html#l00110">P3MLocalMesh::q_2_off</a>, <a class="el" href="config_8hpp_source.html#l00073">ROUND_ERROR_PREC</a>, <a class="el" href="p3m-common_8hpp_source.html#l00093">P3MLocalMesh::size</a>, and <a class="el" href="integrate_8cpp_source.html#l00077">skin</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00185">dp3m_init()</a>, and <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_6b7c06b7a7a76c60d0c114007966a512.html">electrostatics_magnetostatics</a></li><li class="navelem"><a class="el" href="p3m-common_8hpp.html">p3m-common.hpp</a></li>
    <li class="footer">Generated on Tue Aug 31 2021 01:35:09 for ESPResSo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
