<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESPResSo: p3m-dipolar.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo
   </div>
   <div id="projectbrief">Extensible Simulation Package for Research on Soft Matter Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('p3m-dipolar_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">p3m-dipolar.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="config_8hpp_source.html">config.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p3m-dipolar_8hpp_source.html">electrostatics_magnetostatics/p3m-dipolar.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="common_8hpp_source.html">electrostatics_magnetostatics/common.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dp3m__influence__function_8hpp_source.html">electrostatics_magnetostatics/dp3m_influence_function.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fft_8hpp_source.html">electrostatics_magnetostatics/fft.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p3m-common_8hpp_source.html">electrostatics_magnetostatics/p3m-common.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p3m__interpolation_8hpp_source.html">electrostatics_magnetostatics/p3m_interpolation.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p3m__send__mesh_8hpp_source.html">electrostatics_magnetostatics/p3m_send_mesh.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Particle_8hpp_source.html">Particle.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ParticleRange_8hpp_source.html">ParticleRange.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cells_8hpp_source.html">cells.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="communication_8hpp_source.html">communication.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="errorhandling_8hpp_source.html">errorhandling.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="grid_8hpp_source.html">grid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate_8hpp_source.html">integrate.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="npt_8hpp_source.html">npt.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tuning_8hpp_source.html">tuning.hpp</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="Vector_8hpp_source.html">utils/Vector.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="constants_8hpp_source.html">utils/constants.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="integral__parameter_8hpp_source.html">utils/integral_parameter.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="int__pow_8hpp_source.html">utils/math/int_pow.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sinc_8hpp_source.html">utils/math/sinc.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sqr_8hpp_source.html">utils/math/sqr.hpp</a>&gt;</code><br />
<code>#include &lt;boost/mpi/collectives/all_reduce.hpp&gt;</code><br />
<code>#include &lt;boost/mpi/collectives/reduce.hpp&gt;</code><br />
<code>#include &lt;boost/range/algorithm/min_element.hpp&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;array&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for p3m-dipolar.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="p3m-dipolar_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="p3m-dipolar_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceanonymous__namespace_02p3m-dipolar_8cpp_03"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceanonymous__namespace_02p3m-dipolar_8cpp_03.html">anonymous_namespace{p3m-dipolar.cpp}</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acd1cd0e40a6520412974c6ae8e4551b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#acd1cd0e40a6520412974c6ae8e4551b2">DP3M_RTBISECTION_ERROR</a>&#160;&#160;&#160;9999999</td></tr>
<tr class="separator:acd1cd0e40a6520412974c6ae8e4551b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8fb517ae6c0ac3b3413f51a759033ec0"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a8fb517ae6c0ac3b3413f51a759033ec0">calc_surface_term</a> (bool force_flag, bool energy_flag, <a class="el" href="classParticleRange.html">ParticleRange</a> const &amp;particles)</td></tr>
<tr class="memdesc:a8fb517ae6c0ac3b3413f51a759033ec0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the dipolar surface terms.  <a href="p3m-dipolar_8cpp.html#a8fb517ae6c0ac3b3413f51a759033ec0">More...</a><br /></td></tr>
<tr class="separator:a8fb517ae6c0ac3b3413f51a759033ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503b54aca31cb9b01347764f552ce120"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a503b54aca31cb9b01347764f552ce120">dp3m_average_dipolar_self_energy</a> ()</td></tr>
<tr class="memdesc:a503b54aca31cb9b01347764f552ce120"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correction of the dipolar p3m-energy.  <a href="p3m-dipolar_8cpp.html#a503b54aca31cb9b01347764f552ce120">More...</a><br /></td></tr>
<tr class="separator:a503b54aca31cb9b01347764f552ce120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c26c1160ba7da29d67c3d2f39509a2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a6c26c1160ba7da29d67c3d2f39509a2b">dp3m_deactivate</a> ()</td></tr>
<tr class="memdesc:a6c26c1160ba7da29d67c3d2f39509a2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset <a class="el" href="p3m-dipolar_8hpp.html#a7ec17cb59d82d743086a1f8e4f8b335f">dp3m</a> core parameters.  <a href="p3m-dipolar_8cpp.html#a6c26c1160ba7da29d67c3d2f39509a2b">More...</a><br /></td></tr>
<tr class="separator:a6c26c1160ba7da29d67c3d2f39509a2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39364a61643c5b9ceb8385df3b492f95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a39364a61643c5b9ceb8385df3b492f95">dp3m_init</a> ()</td></tr>
<tr class="memdesc:a39364a61643c5b9ceb8385df3b492f95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize all structures, parameters and arrays needed for the P3M algorithm for dipole-dipole interactions.  <a href="p3m-dipolar_8cpp.html#a39364a61643c5b9ceb8385df3b492f95">More...</a><br /></td></tr>
<tr class="separator:a39364a61643c5b9ceb8385df3b492f95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2cd22df6be4ef4e9dd4ad4cc3179d6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#ab2cd22df6be4ef4e9dd4ad4cc3179d6d">dp3m_set_tune_params</a> (double r_cut, int mesh, int cao, double accuracy)</td></tr>
<tr class="memdesc:ab2cd22df6be4ef4e9dd4ad4cc3179d6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set initial values for <a class="el" href="p3m_8cpp.html#ae37be878423a80cc74fcd806e456e35d" title="Tune P3M parameters to desired accuracy.">p3m_adaptive_tune()</a>  <a href="p3m-dipolar_8cpp.html#ab2cd22df6be4ef4e9dd4ad4cc3179d6d">More...</a><br /></td></tr>
<tr class="separator:ab2cd22df6be4ef4e9dd4ad4cc3179d6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4fe7eb42ef1a84482d6d8d40f296942"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#aa4fe7eb42ef1a84482d6d8d40f296942">dp3m_set_params</a> (double r_cut, int mesh, int cao, double alpha, double accuracy)</td></tr>
<tr class="memdesc:aa4fe7eb42ef1a84482d6d8d40f296942"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set custom parameters.  <a href="p3m-dipolar_8cpp.html#aa4fe7eb42ef1a84482d6d8d40f296942">More...</a><br /></td></tr>
<tr class="separator:aa4fe7eb42ef1a84482d6d8d40f296942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539daf45a96b5ce357513b878e2d6059"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a539daf45a96b5ce357513b878e2d6059">dp3m_set_mesh_offset</a> (double x, double y, double z)</td></tr>
<tr class="memdesc:a539daf45a96b5ce357513b878e2d6059"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set mesh offset.  <a href="p3m-dipolar_8cpp.html#a539daf45a96b5ce357513b878e2d6059">More...</a><br /></td></tr>
<tr class="separator:a539daf45a96b5ce357513b878e2d6059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae33267a9318af924549538832fa1fbca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#ae33267a9318af924549538832fa1fbca">dp3m_set_eps</a> (double eps)</td></tr>
<tr class="memdesc:ae33267a9318af924549538832fa1fbca"><td class="mdescLeft">&#160;</td><td class="mdescRight">We left the handling of the epsilon, due to portability reasons in the future for the electrical dipoles, or if people want to do electrical dipoles alone using the magnetic code.  <a href="p3m-dipolar_8cpp.html#ae33267a9318af924549538832fa1fbca">More...</a><br /></td></tr>
<tr class="separator:ae33267a9318af924549538832fa1fbca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af65e13897717a77614ebfa258c4a0864"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#af65e13897717a77614ebfa258c4a0864">dp3m_dipole_assign</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:af65e13897717a77614ebfa258c4a0864"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign the physical dipoles using the tabulated assignment function.  <a href="p3m-dipolar_8cpp.html#af65e13897717a77614ebfa258c4a0864">More...</a><br /></td></tr>
<tr class="separator:af65e13897717a77614ebfa258c4a0864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ead32ac08d152654dbaa24807364230"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a1ead32ac08d152654dbaa24807364230">dp3m_calc_kspace_forces</a> (bool force_flag, bool energy_flag, const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a1ead32ac08d152654dbaa24807364230"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the k-space part of forces and energies for the magnetic dipole-dipole interaction.  <a href="p3m-dipolar_8cpp.html#a1ead32ac08d152654dbaa24807364230">More...</a><br /></td></tr>
<tr class="separator:a1ead32ac08d152654dbaa24807364230"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafde52a0bbb802abcc8b053fa2ba41d8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#aafde52a0bbb802abcc8b053fa2ba41d8">dp3m_get_accuracy</a> (int mesh, int cao, double r_cut_iL, double *_alpha_L, double *_rs_err, double *_ks_err)</td></tr>
<tr class="memdesc:aafde52a0bbb802abcc8b053fa2ba41d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the minimal error for this combination of parameters.  <a href="p3m-dipolar_8cpp.html#aafde52a0bbb802abcc8b053fa2ba41d8">More...</a><br /></td></tr>
<tr class="separator:aafde52a0bbb802abcc8b053fa2ba41d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f7affcd5facc1cb2a15757980870441"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a0f7affcd5facc1cb2a15757980870441">dp3m_mcr_time</a> (int mesh, int cao, double r_cut_iL, double alpha_L, int timings)</td></tr>
<tr class="memdesc:a0f7affcd5facc1cb2a15757980870441"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the computation time for some <code>mesh</code>, <code>cao</code>, <code>r_cut</code> and <code>alpha</code>.  <a href="p3m-dipolar_8cpp.html#a0f7affcd5facc1cb2a15757980870441">More...</a><br /></td></tr>
<tr class="separator:a0f7affcd5facc1cb2a15757980870441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e88cb05d7667414ec87e6319074a5f8"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a1e88cb05d7667414ec87e6319074a5f8">dp3m_mc_time</a> (int mesh, int cao, double r_cut_iL_min, double r_cut_iL_max, double *_r_cut_iL, double *_alpha_L, double *_accuracy, int timings, bool verbose)</td></tr>
<tr class="memdesc:a1e88cb05d7667414ec87e6319074a5f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code> and <code>cao</code>.  <a href="p3m-dipolar_8cpp.html#a1e88cb05d7667414ec87e6319074a5f8">More...</a><br /></td></tr>
<tr class="separator:a1e88cb05d7667414ec87e6319074a5f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aed5ba44ed46a6578be2765a072ae4c"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a2aed5ba44ed46a6578be2765a072ae4c">dp3m_m_time</a> (int mesh, int cao_min, int cao_max, int *_cao, double r_cut_iL_min, double r_cut_iL_max, double *_r_cut_iL, double *_alpha_L, double *_accuracy, int timings, bool verbose)</td></tr>
<tr class="memdesc:a2aed5ba44ed46a6578be2765a072ae4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code>.  <a href="p3m-dipolar_8cpp.html#a2aed5ba44ed46a6578be2765a072ae4c">More...</a><br /></td></tr>
<tr class="separator:a2aed5ba44ed46a6578be2765a072ae4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282527c057c05bba7095cfdd1bfb9956"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a282527c057c05bba7095cfdd1bfb9956">dp3m_adaptive_tune</a> (int timings, bool verbose)</td></tr>
<tr class="memdesc:a282527c057c05bba7095cfdd1bfb9956"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tune dipolar P3M parameters to desired accuracy.  <a href="p3m-dipolar_8cpp.html#a282527c057c05bba7095cfdd1bfb9956">More...</a><br /></td></tr>
<tr class="separator:a282527c057c05bba7095cfdd1bfb9956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01184af8e522bc051f8f238436bdf03d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a01184af8e522bc051f8f238436bdf03d">dp3m_count_magnetic_particles</a> ()</td></tr>
<tr class="memdesc:a01184af8e522bc051f8f238436bdf03d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate number of magnetic particles, the sum of the squared charges and the squared sum of the charges.  <a href="p3m-dipolar_8cpp.html#a01184af8e522bc051f8f238436bdf03d">More...</a><br /></td></tr>
<tr class="separator:a01184af8e522bc051f8f238436bdf03d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3768a11ce332efcac0307b30092df05"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#ae3768a11ce332efcac0307b30092df05">dp3m_sanity_checks</a> (const <a class="el" href="namespaceUtils.html#a40cbc808d5e70b8c462dd45854942e5c">Utils::Vector3i</a> &amp;grid)</td></tr>
<tr class="memdesc:ae3768a11ce332efcac0307b30092df05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sanity checks.  <a href="p3m-dipolar_8cpp.html#ae3768a11ce332efcac0307b30092df05">More...</a><br /></td></tr>
<tr class="separator:ae3768a11ce332efcac0307b30092df05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bfd4457a78a200ce276c810a49904d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a4bfd4457a78a200ce276c810a49904d1">dp3m_scaleby_box_l</a> ()</td></tr>
<tr class="memdesc:a4bfd4457a78a200ce276c810a49904d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update <a class="el" href="structP3MParameters.html#a3584ba7cf5a189c6c98814b1aead35d1">alpha</a> and <a class="el" href="structP3MParameters.html#ac409ec47f19086dfba16ed7dffec48e5">r_cut</a> if box length changed.  <a href="p3m-dipolar_8cpp.html#a4bfd4457a78a200ce276c810a49904d1">More...</a><br /></td></tr>
<tr class="separator:a4bfd4457a78a200ce276c810a49904d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82af1762d31516cb474a76f4f693d10d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a82af1762d31516cb474a76f4f693d10d">npt_add_virial_magnetic_contribution</a> (double energy)</td></tr>
<tr class="memdesc:a82af1762d31516cb474a76f4f693d10d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the NpT virial.  <a href="p3m-dipolar_8cpp.html#a82af1762d31516cb474a76f4f693d10d">More...</a><br /></td></tr>
<tr class="separator:a82af1762d31516cb474a76f4f693d10d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Private Functions</div></td></tr>
<tr class="memitem:accdd054c63734dd2ad9bbdfb097f3aff"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#accdd054c63734dd2ad9bbdfb097f3aff">dp3m_init_a_ai_cao_cut</a> ()</td></tr>
<tr class="memdesc:accdd054c63734dd2ad9bbdfb097f3aff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize for magnetic dipoles the (inverse) mesh constant <a class="el" href="structP3MParameters.html#a3c5bbb63a4216b12ab7d5b4b1c150bfc">a</a> (<a class="el" href="structP3MParameters.html#ac3e474b0410cfdb96c7da77988c870bc">ai</a>) and the cutoff for charge assignment <a class="el" href="structP3MParameters.html#aa36a1725f1bd8665655f375ac49b6bed">cao_cut</a>.  <a href="p3m-dipolar_8cpp.html#accdd054c63734dd2ad9bbdfb097f3aff">More...</a><br /></td></tr>
<tr class="separator:accdd054c63734dd2ad9bbdfb097f3aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40afdd1fb672ed6638251e0acfe338da"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a40afdd1fb672ed6638251e0acfe338da">dp3m_sanity_checks_boxl</a> ()</td></tr>
<tr class="memdesc:a40afdd1fb672ed6638251e0acfe338da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks for correctness for magnetic dipoles in P3M of the cao_cut, necessary when the box length changes.  <a href="p3m-dipolar_8cpp.html#a40afdd1fb672ed6638251e0acfe338da">More...</a><br /></td></tr>
<tr class="separator:a40afdd1fb672ed6638251e0acfe338da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6def101c70bf168ac6bb4374515e9f5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#ae6def101c70bf168ac6bb4374515e9f5">dp3m_calc_influence_function_force</a> ()</td></tr>
<tr class="memdesc:ae6def101c70bf168ac6bb4374515e9f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the influence function optimized for the dipolar forces.  <a href="p3m-dipolar_8cpp.html#ae6def101c70bf168ac6bb4374515e9f5">More...</a><br /></td></tr>
<tr class="separator:ae6def101c70bf168ac6bb4374515e9f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa77fbafd2c171ecb1c6bc894a29564ea"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#aa77fbafd2c171ecb1c6bc894a29564ea">dp3m_calc_influence_function_energy</a> ()</td></tr>
<tr class="memdesc:aa77fbafd2c171ecb1c6bc894a29564ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the influence function optimized for the dipolar energy and torques.  <a href="p3m-dipolar_8cpp.html#aa77fbafd2c171ecb1c6bc894a29564ea">More...</a><br /></td></tr>
<tr class="separator:aa77fbafd2c171ecb1c6bc894a29564ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5da4a058178e6c7c7ae8fbc4a14fe81"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#ac5da4a058178e6c7c7ae8fbc4a14fe81">dp3m_compute_constants_energy_dipolar</a> ()</td></tr>
<tr class="memdesc:ac5da4a058178e6c7c7ae8fbc4a14fe81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the constants necessary to correct the dipolar energy to minimize the error.  <a href="p3m-dipolar_8cpp.html#ac5da4a058178e6c7c7ae8fbc4a14fe81">More...</a><br /></td></tr>
<tr class="separator:ac5da4a058178e6c7c7ae8fbc4a14fe81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a905893ef74156e504ade04d84a182e8b"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a905893ef74156e504ade04d84a182e8b">dp3m_k_space_error</a> (double box_size, double prefac, int mesh, int cao, int n_c_part, double sum_q2, double alpha_L)</td></tr>
<tr class="memdesc:a905893ef74156e504ade04d84a182e8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the k-space error of dipolar-P3M.  <a href="p3m-dipolar_8cpp.html#a905893ef74156e504ade04d84a182e8b">More...</a><br /></td></tr>
<tr class="separator:a905893ef74156e504ade04d84a182e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">P3M Tuning Functions</div></td></tr>
<tr class="memitem:a4d6e8b0700bef3c57db131d3b521e49d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a4d6e8b0700bef3c57db131d3b521e49d">dp3m_real_space_error</a> (double box_size, double prefac, double r_cut_iL, int n_c_part, double sum_q2, double alpha_L)</td></tr>
<tr class="memdesc:a4d6e8b0700bef3c57db131d3b521e49d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the value of the errors for the REAL part of the force in terms of the splitting parameter alpha of Ewald.  <a href="p3m-dipolar_8cpp.html#a4d6e8b0700bef3c57db131d3b521e49d">More...</a><br /></td></tr>
<tr class="separator:a4d6e8b0700bef3c57db131d3b521e49d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1742ed0811046256241893ff0b42f01"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#ae1742ed0811046256241893ff0b42f01">dp3m_tune_aliasing_sums</a> (int nx, int ny, int nz, int mesh, double mesh_i, int cao, double alpha_L_i, double *alias1, double *alias2)</td></tr>
<tr class="memdesc:ae1742ed0811046256241893ff0b42f01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tuning dipolar-P3M.  <a href="p3m-dipolar_8cpp.html#ae1742ed0811046256241893ff0b42f01">More...</a><br /></td></tr>
<tr class="separator:ae1742ed0811046256241893ff0b42f01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ed1c4cbe2c405171bd81a3bb8afcf66"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a5ed1c4cbe2c405171bd81a3bb8afcf66">dp3m_rtbisection</a> (double box_size, double prefac, double r_cut_iL, int n_c_part, double sum_q2, double x1, double x2, double xacc, double tuned_accuracy)</td></tr>
<tr class="memdesc:a5ed1c4cbe2c405171bd81a3bb8afcf66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the value of alpha through a bisection method.  <a href="p3m-dipolar_8cpp.html#a5ed1c4cbe2c405171bd81a3bb8afcf66">More...</a><br /></td></tr>
<tr class="separator:a5ed1c4cbe2c405171bd81a3bb8afcf66"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7ec17cb59d82d743086a1f8e4f8b335f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdp3m__data__struct.html">dp3m_data_struct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="p3m-dipolar_8cpp.html#a7ec17cb59d82d743086a1f8e4f8b335f">dp3m</a></td></tr>
<tr class="memdesc:a7ec17cb59d82d743086a1f8e4f8b335f"><td class="mdescLeft">&#160;</td><td class="mdescRight">dipolar P3M parameters.  <a href="p3m-dipolar_8cpp.html#a7ec17cb59d82d743086a1f8e4f8b335f">More...</a><br /></td></tr>
<tr class="separator:a7ec17cb59d82d743086a1f8e4f8b335f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>P3M algorithm for long range magnetic dipole-dipole interaction.</p>
<dl class="section note"><dt>Note</dt><dd>In general the magnetic dipole-dipole functions bear the same name than the charge-charge, but adding a "D" in front of the name and replacing "charge" by "dipole". In this way one can recognize the similarity of the functions while avoiding nasty confusions in their use.</dd></dl>
<p>By default the magnetic epsilon is metallic = 0.</p>
<p>The corresponding header file is <a class="el" href="p3m-dipolar_8hpp.html">p3m-dipolar.hpp</a>. </p>

<p class="definition">Definition in file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="acd1cd0e40a6520412974c6ae8e4551b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd1cd0e40a6520412974c6ae8e4551b2">&#9670;&nbsp;</a></span>DP3M_RTBISECTION_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DP3M_RTBISECTION_ERROR&#160;&#160;&#160;9999999</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00080">80</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8fb517ae6c0ac3b3413f51a759033ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fb517ae6c0ac3b3413f51a759033ec0">&#9670;&nbsp;</a></span>calc_surface_term()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double calc_surface_term </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>energy_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classParticleRange.html">ParticleRange</a> const &amp;&#160;</td>
          <td class="paramname"><em>particles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the dipolar surface terms. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00644">644</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="ParticleRange_8hpp_source.html#l00043">ParticleRange::size()</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00381">dp3m_calc_kspace_forces()</a>.</p>

</div>
</div>
<a id="a282527c057c05bba7095cfdd1bfb9956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a282527c057c05bba7095cfdd1bfb9956">&#9670;&nbsp;</a></span>dp3m_adaptive_tune()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dp3m_adaptive_tune </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tune dipolar P3M parameters to desired accuracy. </p>
<p>The parameters <a class="el" href="structP3MParameters.html#a7cc8344779c25939a75d7363a2ef0645">mesh</a>, <a class="el" href="structP3MParameters.html#a578a99326ade4c2b93287d6be4527996">cao</a>, <a class="el" href="structP3MParameters.html#a54ee4a4b7a374690203f6d1e641b3457">r_cut_iL</a> and <a class="el" href="structP3MParameters.html#a66edee020fd1dc6497d35b764bfd2938">alpha_L</a> are tuned to obtain the target accuracy (initially stored in <a class="el" href="structP3MParameters.html#a5b85854a94374889d5758e3efdb9886a">accuracy</a>) in optimal time. These parameters are stored in the <a class="el" href="p3m-dipolar_8hpp.html#a7ec17cb59d82d743086a1f8e4f8b335f">dp3m</a> object.</p>
<p>The function utilizes the analytic expression of the error estimate for the dipolar P3M method in the paper of <a class="el" href="citelist.html#CITEREF_cerda08d">[10]</a> in order to obtain the rms error in the force for a system of N randomly distributed particles in a cubic box. For the real space error, the estimate in <a class="el" href="citelist.html#CITEREF_kolafa92a">[29]</a> is used.</p>
<p>Parameter ranges if not given explicit values via <a class="el" href="p3m-dipolar_8hpp.html#ab2cd22df6be4ef4e9dd4ad4cc3179d6d" title="Set initial values for p3m_adaptive_tune()">dp3m_set_tune_params()</a>:</p><ul>
<li><code>mesh</code> is set up such that the number of mesh points is equal to the number of magnetic dipolar particles</li>
<li><code>cao</code> explores all possible values</li>
<li><code>alpha_L</code> is tuned for each tuple (<code>r_cut_iL</code>, <code>mesh</code>, <code>cao</code>) and calculated assuming that the error contributions of real and reciprocal space should be equal</li>
</ul>
<p>After checking if the total error lies below the target accuracy, the time needed for one force calculation (including Verlet list update) is measured via <a class="el" href="tuning_8cpp.html#a1966673e670f08cb1c1ee4ea4428d37c" title="Measure the time for some force calculations.">time_force_calc()</a>.</p>
<p>The function generates a log of the performed tuning.</p>
<p>The function is based on routines of the program HE_Q.cpp for charges written by M. Deserno.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verbose</td><td>printf output </td></tr>
    <tr><td class="paramname">timings</td><td>Number of test force calculations </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ES_OK</td><td></td></tr>
    <tr><td class="paramname">ES_ERROR</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Tuning of dipolar P3M. The algorithm basically determines the mesh, cao and then the real space cutoff, in this nested order.</p>
<p>For each mesh, the cao optimal for the mesh tested previously is used as an initial guess, and the algorithm tries whether increasing or decreasing it leads to a better solution. This is efficient, since the optimal cao only changes little with the meshes in general.</p>
<p>The real space cutoff for a given mesh and cao is determined via a bisection on the error estimate, which determines where the error estimate equals the required accuracy. Therefore the smallest possible, i.e. fastest real space cutoff is determined.</p>
<p>Both the search over mesh and cao stop to search in a specific direction once the computation time is significantly higher than the currently known optimum.</p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01079">1079</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01230">dp3m_count_magnetic_particles()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00947">dp3m_m_time()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00080">DP3M_RTBISECTION_ERROR</a>, <a class="el" href="constants_8hpp_source.html#l00080">ES_ERROR</a>, <a class="el" href="constants_8hpp_source.html#l00078">ES_OK</a>, <a class="el" href="LocalBox_8hpp_source.html#l00044">LocalBox&lt; T &gt;::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="Correlator_8cpp_source.html#l00048">anonymous_namespace{Correlator.cpp}::min()</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="communication_8hpp_source.html#l00106">mpi_call_all()</a>, <a class="el" href="config_8hpp_source.html#l00060">P3M_MAX_MESH</a>, <a class="el" href="p3m-common_8hpp_source.html#l00079">P3M_TIME_GRAN</a>, <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>, <a class="el" href="integrate_8cpp_source.html#l00077">skin</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00071">dp3m_data_struct::sum_dip_part</a>, and <a class="el" href="p3m-dipolar_8hpp_source.html#l00073">dp3m_data_struct::sum_mu2</a>.</p>

</div>
</div>
<a id="a503b54aca31cb9b01347764f552ce120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503b54aca31cb9b01347764f552ce120">&#9670;&nbsp;</a></span>dp3m_average_dipolar_self_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dp3m_average_dipolar_self_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Correction of the dipolar p3m-energy. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00147">147</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00086">dp3m_data_struct::fft</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00042">p3m_data_struct_base::g_energy</a>, <a class="el" href="dp3m__influence__function_8hpp_source.html#l00189">grid_influence_function_self_energy()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, and <a class="el" href="fft_8hpp_source.html#l00110">fft_forw_plan::start</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01485">dp3m_compute_constants_energy_dipolar()</a>.</p>

</div>
</div>
<a id="aa77fbafd2c171ecb1c6bc894a29564ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa77fbafd2c171ecb1c6bc894a29564ea">&#9670;&nbsp;</a></span>dp3m_calc_influence_function_energy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_calc_influence_function_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the influence function optimized for the dipolar energy and torques. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00719">719</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00086">dp3m_data_struct::fft</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00042">p3m_data_struct_base::g_energy</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, and <a class="el" href="fft_8hpp_source.html#l00110">fft_forw_plan::start</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">dp3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="ae6def101c70bf168ac6bb4374515e9f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6def101c70bf168ac6bb4374515e9f5">&#9670;&nbsp;</a></span>dp3m_calc_influence_function_force()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_calc_influence_function_force </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the influence function optimized for the dipolar forces. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00711">711</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00086">dp3m_data_struct::fft</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00040">p3m_data_struct_base::g_force</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, and <a class="el" href="fft_8hpp_source.html#l00110">fft_forw_plan::start</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">dp3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="a1ead32ac08d152654dbaa24807364230"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ead32ac08d152654dbaa24807364230">&#9670;&nbsp;</a></span>dp3m_calc_kspace_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dp3m_calc_kspace_forces </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>energy_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the k-space part of forces and energies for the magnetic dipole-dipole interaction. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00381">381</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00644">calc_surface_term()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00038">p3m_data_struct_base::d_op</a>, <a class="el" href="p3m-common_8hpp_source.html#l00091">P3MLocalMesh::dim</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01485">dp3m_compute_constants_energy_dipolar()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00084">dp3m_data_struct::energy_correction</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00086">dp3m_data_struct::fft</a>, <a class="el" href="fft_8cpp_source.html#l00715">fft_perform_back()</a>, <a class="el" href="fft_8cpp_source.html#l00684">fft_perform_forw()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00042">p3m_data_struct_base::g_energy</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00040">p3m_data_struct_base::g_force</a>, <a class="el" href="p3m__send__mesh_8cpp_source.html#l00111">p3m_send_mesh::gather_grid()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00068">dp3m_data_struct::ks_mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00045">p3m_data_struct_base::ks_pnum</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00062">dp3m_data_struct::local_mesh</a>, <a class="el" href="Span_8hpp_source.html#l00116">Utils::make_span()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="fft_8hpp_source.html#l00108">fft_forw_plan::new_mesh</a>, <a class="el" href="p3m-common_8hpp_source.html#l00074">P3M_EPSILON_METALLIC</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="fft_8hpp_source.html#l00153">fft_data_struct::plan</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00064">dp3m_data_struct::rs_mesh</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00066">dp3m_data_struct::rs_mesh_dip</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00081">dp3m_data_struct::sm</a>, <a class="el" href="p3m__send__mesh_8cpp_source.html#l00149">p3m_send_mesh::spread_grid()</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="constants_8hpp_source.html#l00043">Utils::sqrt_pi_i()</a>, <a class="el" href="fft_8hpp_source.html#l00110">fft_forw_plan::start</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00073">dp3m_data_struct::sum_mu2</a>, <a class="el" href="communication_8cpp_source.html#l00062">this_node</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dipole_8cpp_source.html#l00220">Dipole::calc_energy_long_range()</a>, and <a class="el" href="dipole_8cpp_source.html#l00170">Dipole::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="ac5da4a058178e6c7c7ae8fbc4a14fe81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5da4a058178e6c7c7ae8fbc4a14fe81">&#9670;&nbsp;</a></span>dp3m_compute_constants_energy_dipolar()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_compute_constants_energy_dipolar </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the constants necessary to correct the dipolar energy to minimize the error. </p>
<p>Calculate the dipolar-P3M energy correction. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01485">1485</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00147">dp3m_average_dipolar_self_energy()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00084">dp3m_data_struct::energy_correction</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="constants_8hpp_source.html#l00043">Utils::sqrt_pi_i()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00073">dp3m_data_struct::sum_mu2</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00381">dp3m_calc_kspace_forces()</a>.</p>

</div>
</div>
<a id="a01184af8e522bc051f8f238436bdf03d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01184af8e522bc051f8f238436bdf03d">&#9670;&nbsp;</a></span>dp3m_count_magnetic_particles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_count_magnetic_particles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate number of magnetic particles, the sum of the squared charges and the squared sum of the charges. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01230">1230</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="cells_8cpp_source.html#l00052">cell_structure</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="CellStructure_8cpp_source.html#l00193">CellStructure::local_particles()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00071">dp3m_data_struct::sum_dip_part</a>, and <a class="el" href="p3m-dipolar_8hpp_source.html#l00073">dp3m_data_struct::sum_mu2</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01079">dp3m_adaptive_tune()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00185">dp3m_init()</a>, and <a class="el" href="dipole_8cpp_source.html#l00109">Dipole::on_observable_calc()</a>.</p>

</div>
</div>
<a id="a6c26c1160ba7da29d67c3d2f39509a2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c26c1160ba7da29d67c3d2f39509a2b">&#9670;&nbsp;</a></span>dp3m_deactivate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_deactivate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset <a class="el" href="p3m-dipolar_8hpp.html#a7ec17cb59d82d743086a1f8e4f8b335f">dp3m</a> core parameters. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00174">174</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>.</p>

</div>
</div>
<a id="af65e13897717a77614ebfa258c4a0864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af65e13897717a77614ebfa258c4a0864">&#9670;&nbsp;</a></span>dp3m_dipole_assign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_dipole_assign </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign the physical dipoles using the tabulated assignment function. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00322">322</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00078">dp3m_data_struct::inter_weights</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00062">dp3m_data_struct::local_mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="p3m__interpolation_8hpp_source.html#l00125">p3m_interpolation_cache::reset()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00066">dp3m_data_struct::rs_mesh_dip</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00093">P3MLocalMesh::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="dipole_8cpp_source.html#l00220">Dipole::calc_energy_long_range()</a>, and <a class="el" href="dipole_8cpp_source.html#l00170">Dipole::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="aafde52a0bbb802abcc8b053fa2ba41d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafde52a0bbb802abcc8b053fa2ba41d8">&#9670;&nbsp;</a></span>dp3m_get_accuracy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dp3m_get_accuracy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_rs_err</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_ks_err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the minimal error for this combination of parameters. </p>
<p>The real space error is tuned such that it contributes half of the total error, and then the Fourier space error is calculated. If an optimal alpha is not found, the value 0.1 is used as fallback. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_rs_err</td><td>real space error </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_ks_err</td><td>Fourier space error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error magnitude </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00742">742</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01249">dp3m_k_space_error()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01316">dp3m_real_space_error()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01349">dp3m_rtbisection()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00080">DP3M_RTBISECTION_ERROR</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>, <a class="el" href="constants_8hpp_source.html#l00064">Utils::sqrt_2()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00071">dp3m_data_struct::sum_dip_part</a>, and <a class="el" href="p3m-dipolar_8hpp_source.html#l00073">dp3m_data_struct::sum_mu2</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00838">dp3m_mc_time()</a>.</p>

</div>
</div>
<a id="a39364a61643c5b9ceb8385df3b492f95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39364a61643c5b9ceb8385df3b492f95">&#9670;&nbsp;</a></span>dp3m_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize all structures, parameters and arrays needed for the P3M algorithm for dipole-dipole interactions. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00185">185</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-data__struct_8hpp_source.html#l00051">p3m_data_struct_base::calc_differential_operator()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-common_8hpp_source.html#l00149">P3MParameters::cao3</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="p3m-common_8hpp_source.html#l00091">P3MLocalMesh::dim</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01230">dp3m_count_magnetic_particles()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01386">dp3m_init_a_ai_cao_cut()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01420">dp3m_sanity_checks()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">dp3m_scaleby_box_l()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00086">dp3m_data_struct::fft</a>, <a class="el" href="fft_8cpp_source.html#l00485">fft_init()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00068">dp3m_data_struct::ks_mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00045">p3m_data_struct_base::ks_pnum</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00062">dp3m_data_struct::local_mesh</a>, <a class="el" href="p3m-common_8hpp_source.html#l00106">P3MLocalMesh::margin</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m-common_8hpp_source.html#l00127">P3MParameters::mesh_off</a>, <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>, <a class="el" href="p3m-common_8cpp_source.html#l00116">p3m_calc_local_ca_mesh()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, <a class="el" href="p3m__send__mesh_8cpp_source.html#l00036">p3m_send_mesh::resize()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00064">dp3m_data_struct::rs_mesh</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00066">dp3m_data_struct::rs_mesh_dip</a>, <a class="el" href="integrate_8cpp_source.html#l00077">skin</a>, and <a class="el" href="p3m-dipolar_8hpp_source.html#l00081">dp3m_data_struct::sm</a>.</p>

<p class="reference">Referenced by <a class="el" href="dipole_8cpp_source.html#l00156">Dipole::init()</a>, and <a class="el" href="dipole_8cpp_source.html#l00123">Dipole::on_coulomb_change()</a>.</p>

</div>
</div>
<a id="accdd054c63734dd2ad9bbdfb097f3aff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accdd054c63734dd2ad9bbdfb097f3aff">&#9670;&nbsp;</a></span>dp3m_init_a_ai_cao_cut()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_init_a_ai_cao_cut </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize for magnetic dipoles the (inverse) mesh constant <a class="el" href="structP3MParameters.html#a3c5bbb63a4216b12ab7d5b4b1c150bfc">a</a> (<a class="el" href="structP3MParameters.html#ac3e474b0410cfdb96c7da77988c870bc">ai</a>) and the cutoff for charge assignment <a class="el" href="structP3MParameters.html#aa36a1725f1bd8665655f375ac49b6bed">cao_cut</a>. </p>
<p>Function called by <a class="el" href="p3m-dipolar_8cpp.html#a39364a61643c5b9ceb8385df3b492f95">dp3m_init()</a> once and by <a class="el" href="p3m-dipolar_8cpp.html#a4bfd4457a78a200ce276c810a49904d1">dp3m_scaleby_box_l()</a> whenever the box_length changes. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01386">1386</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00138">P3MParameters::a</a>, <a class="el" href="p3m-common_8hpp_source.html#l00140">P3MParameters::ai</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-common_8hpp_source.html#l00136">P3MParameters::cao_cut</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00185">dp3m_init()</a>, and <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">dp3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="a905893ef74156e504ade04d84a182e8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a905893ef74156e504ade04d84a182e8b">&#9670;&nbsp;</a></span>dp3m_k_space_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double dp3m_k_space_error </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>box_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prefac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_c_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sum_q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate the k-space error of dipolar-P3M. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01249">1249</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-dipolar_8cpp_source.html#l01280">dp3m_tune_aliasing_sums()</a>, <a class="el" href="p3m-common_8cpp_source.html#l00063">p3m_analytic_cotangent_sum()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="config_8hpp_source.html#l00073">ROUND_ERROR_PREC</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, and <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00742">dp3m_get_accuracy()</a>.</p>

</div>
</div>
<a id="a2aed5ba44ed46a6578be2765a072ae4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aed5ba44ed46a6578be2765a072ae4c">&#9670;&nbsp;</a></span>dp3m_m_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double dp3m_m_time </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>_cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code>. </p>
<p><code>_cao</code> should contain an initial guess, which is then adapted by stepping up and down.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao_min</td><td>lower bound for <code>_cao</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao_max</td><td>upper bound for <code>_cao</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">_cao</td><td>initial guess for the charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_min</td><td>lower bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_max</td><td>upper bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_accuracy</td><td>accuracy of the actual parameter set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timings</td><td>Number of test force calculations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>printf output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integration time in case of success, otherwise -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8">P3M_TUNE_FAIL</a> or -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a46906b66a49469b01be67b3a6a5ddcb7">P3M_TUNE_CAO_TOO_LARGE</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00947">947</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-dipolar_8cpp_source.html#l00838">dp3m_mc_time()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00080">DP3M_RTBISECTION_ERROR</a>, <a class="el" href="p3m-common_8hpp_source.html#l00079">P3M_TIME_GRAN</a>, <a class="el" href="p3m-common_8hpp_source.html#l00054">P3M_TUNE_CAO_TOO_LARGE</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01079">dp3m_adaptive_tune()</a>.</p>

</div>
</div>
<a id="a1e88cb05d7667414ec87e6319074a5f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e88cb05d7667414ec87e6319074a5f8">&#9670;&nbsp;</a></span>dp3m_mc_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double dp3m_mc_time </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>_accuracy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the optimal alpha and the corresponding computation time for a fixed <code>mesh</code> and <code>cao</code>. </p>
<p>The <code>_r_cut_iL</code> is determined via a simple bisection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_min</td><td>lower bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL_max</td><td>upper bound for <code>_r_cut_iL</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">_accuracy</td><td>accuracy of the actual parameter set. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timings</td><td>Number of test force calculations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>printf output</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integration time in case of success, otherwise -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8">P3M_TUNE_FAIL</a>, -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a060f6731104fa7a5d35e33030498fce6">P3M_TUNE_ACCURACY_TOO_LARGE</a>, -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a46906b66a49469b01be67b3a6a5ddcb7">P3M_TUNE_CAO_TOO_LARGE</a>, -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a9cf881fe29103872b8dad34bcf3b5692">P3M_TUNE_ELCTEST</a>, or -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389aeb760b434a9b7fb53fce091e018030d6">P3M_TUNE_CUTOFF_TOO_LARGE</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00838">838</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="dipole_8hpp_source.html#l00043">DIPOLAR_MDLC_P3M</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00742">dp3m_get_accuracy()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00799">dp3m_mcr_time()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00080">DP3M_RTBISECTION_ERROR</a>, <a class="el" href="LocalBox_8hpp_source.html#l00044">LocalBox&lt; T &gt;::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="dipole_8hpp_source.html#l00064">Dipole_parameters::method</a>, <a class="el" href="Correlator_8cpp_source.html#l00048">anonymous_namespace{Correlator.cpp}::min()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00077">P3M_RCUT_PREC</a>, <a class="el" href="p3m-common_8hpp_source.html#l00059">P3M_TUNE_ACCURACY_TOO_LARGE</a>, <a class="el" href="p3m-common_8hpp_source.html#l00054">P3M_TUNE_CAO_TOO_LARGE</a>, <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>, and <a class="el" href="integrate_8cpp_source.html#l00077">skin</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00947">dp3m_m_time()</a>.</p>

</div>
</div>
<a id="a0f7affcd5facc1cb2a15757980870441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f7affcd5facc1cb2a15757980870441">&#9670;&nbsp;</a></span>dp3m_mcr_time()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double dp3m_mcr_time </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the computation time for some <code>mesh</code>, <code>cao</code>, <code>r_cut</code> and <code>alpha</code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut_iL</td><td>cutoff radius for real space electrostatics (&gt;0), rescaled to <code>r_cut_iL</code> = <code>r_cut</code> * <code>box_l_i</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha_L</td><td>Ewald splitting parameter (0&lt;alpha&lt;1), rescaled to <code>alpha_L</code> = <code>alpha</code> * <code>box_l</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timings</td><td>Number of test force calculations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integration time in case of success, otherwise -<a class="el" href="p3m-common_8hpp.html#ab0d016305579047d33306fe0fb12a389a76c04e50b4d014165af40cdc85dee2f8">P3M_TUNE_FAIL</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00799">799</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="dipole_8hpp_source.html#l00043">DIPOLAR_MDLC_P3M</a>, <a class="el" href="dipole_8hpp_source.html#l00041">DIPOLAR_P3M</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="dipole_8hpp_source.html#l00064">Dipole_parameters::method</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00050">P3M_TUNE_FAIL</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, <a class="el" href="dipole_8cpp_source.html#l00296">Dipole::set_method_local()</a>, and <a class="el" href="tuning_8cpp_source.html#l00042">time_force_calc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00838">dp3m_mc_time()</a>.</p>

</div>
</div>
<a id="a4d6e8b0700bef3c57db131d3b521e49d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d6e8b0700bef3c57db131d3b521e49d">&#9670;&nbsp;</a></span>dp3m_real_space_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dp3m_real_space_error </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>box_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prefac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_c_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sum_q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the value of the errors for the REAL part of the force in terms of the splitting parameter alpha of Ewald. </p>
<p>Based on eq. (33) <a class="el" href="citelist.html#CITEREF_wang01a">[52]</a>.</p>
<p>Please note that in this more refined approach we don't use eq. (37), but eq. (33) which maintains all the powers in alpha. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01316">1316</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, and <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00742">dp3m_get_accuracy()</a>, and <a class="el" href="p3m-dipolar_8cpp_source.html#l01349">dp3m_rtbisection()</a>.</p>

</div>
</div>
<a id="a5ed1c4cbe2c405171bd81a3bb8afcf66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ed1c4cbe2c405171bd81a3bb8afcf66">&#9670;&nbsp;</a></span>dp3m_rtbisection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dp3m_rtbisection </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>box_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prefac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut_iL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_c_part</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sum_q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xacc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tuned_accuracy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the value of alpha through a bisection method. </p>
<p>Using bisection, find the root of a function "func-tuned_accuracy/sqrt(2.)" known to lie between x1 and x2.</p>
<p>Based on eq. (33) <a class="el" href="citelist.html#CITEREF_wang01a">[52]</a>.</p>
<p>The root, returned as rtbis, will be refined until its accuracy is \(\pm\) <code>xacc</code>. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01349">1349</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-dipolar_8cpp_source.html#l01316">dp3m_real_space_error()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00080">DP3M_RTBISECTION_ERROR</a>, <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>, and <a class="el" href="constants_8hpp_source.html#l00064">Utils::sqrt_2()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00742">dp3m_get_accuracy()</a>.</p>

</div>
</div>
<a id="ae3768a11ce332efcac0307b30092df05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3768a11ce332efcac0307b30092df05">&#9670;&nbsp;</a></span>dp3m_sanity_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool dp3m_sanity_checks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceUtils.html#a40cbc808d5e70b8c462dd45854942e5c">Utils::Vector3i</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sanity checks. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01420">1420</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="cells_8cpp_source.html#l00052">cell_structure</a>, <a class="el" href="CellStructure_8hpp_source.html#l00052">CELL_STRUCTURE_DOMDEC</a>, <a class="el" href="CellStructure_8hpp_source.html#l00247">CellStructure::decomposition_type()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01396">dp3m_sanity_checks_boxl()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00097">BoxGeometry::periodic()</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00185">dp3m_init()</a>, and <a class="el" href="dipole_8cpp_source.html#l00067">Dipole::nonbonded_sanity_check()</a>.</p>

</div>
</div>
<a id="a40afdd1fb672ed6638251e0acfe338da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40afdd1fb672ed6638251e0acfe338da">&#9670;&nbsp;</a></span>dp3m_sanity_checks_boxl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool dp3m_sanity_checks_boxl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks for correctness for magnetic dipoles in P3M of the cao_cut, necessary when the box length changes. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01396">1396</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00136">P3MParameters::cao_cut</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="LocalBox_8hpp_source.html#l00044">LocalBox&lt; T &gt;::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00118">BoxGeometry::length_half()</a>, <a class="el" href="grid_8cpp_source.html#l00047">local_geo</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01420">dp3m_sanity_checks()</a>, and <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">dp3m_scaleby_box_l()</a>.</p>

</div>
</div>
<a id="a4bfd4457a78a200ce276c810a49904d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bfd4457a78a200ce276c810a49904d1">&#9670;&nbsp;</a></span>dp3m_scaleby_box_l()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_scaleby_box_l </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update <a class="el" href="structP3MParameters.html#a3584ba7cf5a189c6c98814b1aead35d1">alpha</a> and <a class="el" href="structP3MParameters.html#ac409ec47f19086dfba16ed7dffec48e5">r_cut</a> if box length changed. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">1468</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00719">dp3m_calc_influence_function_energy()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00711">dp3m_calc_influence_function_force()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01386">dp3m_init_a_ai_cao_cut()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01396">dp3m_sanity_checks_boxl()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00062">dp3m_data_struct::local_mesh</a>, <a class="el" href="p3m-common_8cpp_source.html#l00193">p3m_calc_lm_ld_pos()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l00185">dp3m_init()</a>, and <a class="el" href="dipole_8cpp_source.html#l00137">Dipole::on_boxl_change()</a>.</p>

</div>
</div>
<a id="ae33267a9318af924549538832fa1fbca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae33267a9318af924549538832fa1fbca">&#9670;&nbsp;</a></span>dp3m_set_eps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_set_eps </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We left the handling of the epsilon, due to portability reasons in the future for the electrical dipoles, or if people want to do electrical dipoles alone using the magnetic code. </p>
<p>Set <a class="el" href="structP3MParameters.html#ae85b071ed00fbffbaf298a4a33a75aea">epsilon</a> parameter.</p>
<p>Currently unused. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00299">299</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

</div>
</div>
<a id="a539daf45a96b5ce357513b878e2d6059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a539daf45a96b5ce357513b878e2d6059">&#9670;&nbsp;</a></span>dp3m_set_mesh_offset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_set_mesh_offset </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set mesh offset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x,y,z</td><td>Components of <a class="el" href="structP3MParameters.html#a70b180e29a641c610519136db4c2dc16">mesh_off</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00281">281</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00127">P3MParameters::mesh_off</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, and <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>.</p>

</div>
</div>
<a id="aa4fe7eb42ef1a84482d6d8d40f296942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4fe7eb42ef1a84482d6d8d40f296942">&#9670;&nbsp;</a></span>dp3m_set_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_set_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set custom parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut</td><td>unscaled <a class="el" href="structP3MParameters.html#a54ee4a4b7a374690203f6d1e641b3457">r_cut_iL</a> for use with fast inline functions only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>unscaled <a class="el" href="structP3MParameters.html#a66edee020fd1dc6497d35b764bfd2938">alpha_L</a> for use with fast inline functions only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">accuracy</td><td>accuracy of the actual parameter set. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00247">247</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="p3m-common_8hpp_source.html#l00143">P3MParameters::alpha</a>, <a class="el" href="p3m-common_8hpp_source.html#l00119">P3MParameters::alpha_L</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="dipole_8hpp_source.html#l00043">DIPOLAR_MDLC_P3M</a>, <a class="el" href="dipole_8hpp_source.html#l00041">DIPOLAR_P3M</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="dipole_8hpp_source.html#l00064">Dipole_parameters::method</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>, and <a class="el" href="dipole_8cpp_source.html#l00296">Dipole::set_method_local()</a>.</p>

</div>
</div>
<a id="ab2cd22df6be4ef4e9dd4ad4cc3179d6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2cd22df6be4ef4e9dd4ad4cc3179d6d">&#9670;&nbsp;</a></span>dp3m_set_tune_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_set_tune_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>accuracy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set initial values for <a class="el" href="p3m_8cpp.html#ae37be878423a80cc74fcd806e456e35d" title="Tune P3M parameters to desired accuracy.">p3m_adaptive_tune()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_cut</td><td>unscaled <a class="el" href="structP3MParameters.html#a54ee4a4b7a374690203f6d1e641b3457">r_cut_iL</a> for use with fast inline functions only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>number of mesh points per coordinate direction (&gt;0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cao</td><td>charge assignment order ([0,7]). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">accuracy</td><td>accuracy of the actual parameter set. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00229">229</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="p3m-common_8hpp_source.html#l00131">P3MParameters::accuracy</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00124">P3MParameters::mesh</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00122">P3MParameters::r_cut_iL</a>.</p>

</div>
</div>
<a id="ae1742ed0811046256241893ff0b42f01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1742ed0811046256241893ff0b42f01">&#9670;&nbsp;</a></span>dp3m_tune_aliasing_sums()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void dp3m_tune_aliasing_sums </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mesh_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cao</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_L_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>alias1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>alias2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Tuning dipolar-P3M. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01280">1280</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="config_8hpp_source.html#l00053">P3M_BRILLOUIN</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="sinc_8hpp_source.html#l00045">Utils::sinc()</a>, and <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8cpp_source.html#l01249">dp3m_k_space_error()</a>.</p>

</div>
</div>
<a id="a82af1762d31516cb474a76f4f693d10d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82af1762d31516cb474a76f4f693d10d">&#9670;&nbsp;</a></span>npt_add_virial_magnetic_contribution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void npt_add_virial_magnetic_contribution </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the NpT virial. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l01499">1499</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">References <a class="el" href="npt_8cpp_source.html#l00182">npt_add_virial_contribution()</a>.</p>

<p class="reference">Referenced by <a class="el" href="p3m-dipolar_8hpp_source.html#l00183">dp3m_pair_force()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7ec17cb59d82d743086a1f8e4f8b335f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ec17cb59d82d743086a1f8e4f8b335f">&#9670;&nbsp;</a></span>dp3m</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdp3m__data__struct.html">dp3m_data_struct</a> dp3m</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>dipolar P3M parameters. </p>

<p class="definition">Definition at line <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">86</a> of file <a class="el" href="p3m-dipolar_8cpp_source.html">p3m-dipolar.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00380">add_mdlc_energy_corrections()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00326">add_mdlc_force_corrections()</a>, <a class="el" href="dipole_8cpp_source.html#l00269">Dipole::bcast_params()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00644">calc_surface_term()</a>, <a class="el" href="dipole_8cpp_source.html#l00094">Dipole::cutoff()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01079">dp3m_adaptive_tune()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00147">dp3m_average_dipolar_self_energy()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00719">dp3m_calc_influence_function_energy()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00711">dp3m_calc_influence_function_force()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00381">dp3m_calc_kspace_forces()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01485">dp3m_compute_constants_energy_dipolar()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01230">dp3m_count_magnetic_particles()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00174">dp3m_deactivate()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00322">dp3m_dipole_assign()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00742">dp3m_get_accuracy()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00185">dp3m_init()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01386">dp3m_init_a_ai_cao_cut()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00838">dp3m_mc_time()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00799">dp3m_mcr_time()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00243">dp3m_pair_energy()</a>, <a class="el" href="p3m-dipolar_8hpp_source.html#l00183">dp3m_pair_force()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01420">dp3m_sanity_checks()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01396">dp3m_sanity_checks_boxl()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l01468">dp3m_scaleby_box_l()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00299">dp3m_set_eps()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00281">dp3m_set_mesh_offset()</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00247">dp3m_set_params()</a>, and <a class="el" href="p3m-dipolar_8cpp_source.html#l00229">dp3m_set_tune_params()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_6b7c06b7a7a76c60d0c114007966a512.html">electrostatics_magnetostatics</a></li><li class="navelem"><a class="el" href="p3m-dipolar_8cpp.html">p3m-dipolar.cpp</a></li>
    <li class="footer">Generated on Tue Aug 31 2021 01:35:09 for ESPResSo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
