<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESPResSo: elc.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo
   </div>
   <div id="projectbrief">Extensible Simulation Package for Research on Soft Matter Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('elc_8hpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">elc.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ELC algorithm for long-range <a class="el" href="namespaceCoulomb.html">Coulomb</a> interactions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8hpp_source.html">config.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Particle_8hpp_source.html">Particle.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ParticleRange_8hpp_source.html">ParticleRange.hpp</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="Vector_8hpp_source.html">utils/Vector.hpp</a>&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for elc.hpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="elc_8hpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="elc_8hpp__dep__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="elc_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structELCParameters.html">ELCParameters</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters for the ELC method.  <a href="structELCParameters.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a66eb1e69b43e9483dc72282fd67af266"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a66eb1e69b43e9483dc72282fd67af266">ELC_set_params</a> (double <a class="el" href="Mmm1dgpuForce__cuda_8cu.html#a1b210fdcda96c31426a7ddc6691d5175">maxPWerror</a>, double min_dist, double far_cut, bool neutralize, double delta_mid_top, double delta_mid_bot, bool const_pot, double pot_diff)</td></tr>
<tr class="memdesc:a66eb1e69b43e9483dc72282fd67af266"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set parameters for ELC.  <a href="elc_8hpp.html#a66eb1e69b43e9483dc72282fd67af266">More...</a><br /></td></tr>
<tr class="separator:a66eb1e69b43e9483dc72282fd67af266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bf4b36c5ac7b6b74ce5859e79af5640"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a0bf4b36c5ac7b6b74ce5859e79af5640">ELC_add_force</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a0bf4b36c5ac7b6b74ce5859e79af5640"><td class="mdescLeft">&#160;</td><td class="mdescRight">the force calculation  <a href="elc_8hpp.html#a0bf4b36c5ac7b6b74ce5859e79af5640">More...</a><br /></td></tr>
<tr class="separator:a0bf4b36c5ac7b6b74ce5859e79af5640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97c568509320a43d99b56ab911394378"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a97c568509320a43d99b56ab911394378">ELC_energy</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a97c568509320a43d99b56ab911394378"><td class="mdescLeft">&#160;</td><td class="mdescRight">the energy calculation  <a href="elc_8hpp.html#a97c568509320a43d99b56ab911394378">More...</a><br /></td></tr>
<tr class="separator:a97c568509320a43d99b56ab911394378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a241dba2d50ca461997dd693ebbee053e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a241dba2d50ca461997dd693ebbee053e">ELC_sanity_checks</a> (<a class="el" href="structELCParameters.html">ELCParameters</a> const &amp;<a class="el" href="steepest__descent_8cpp.html#a7c810f3a2b554c3abe0c472e66645420">params</a>)</td></tr>
<tr class="memdesc:a241dba2d50ca461997dd693ebbee053e"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the ELC parameters  <a href="elc_8hpp.html#a241dba2d50ca461997dd693ebbee053e">More...</a><br /></td></tr>
<tr class="separator:a241dba2d50ca461997dd693ebbee053e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3046e64e7bdbc5b933b8358414701199"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a3046e64e7bdbc5b933b8358414701199">ELC_init</a> ()</td></tr>
<tr class="memdesc:a3046e64e7bdbc5b933b8358414701199"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize the ELC constants  <a href="elc_8hpp.html#a3046e64e7bdbc5b933b8358414701199">More...</a><br /></td></tr>
<tr class="separator:a3046e64e7bdbc5b933b8358414701199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c2db2ae4c3ac949b767f2d9ebbe43a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a18c2db2ae4c3ac949b767f2d9ebbe43a">ELC_P3M_dielectric_layers_energy_contribution</a> (<a class="el" href="structParticle.html">Particle</a> const &amp;p1, <a class="el" href="structParticle.html">Particle</a> const &amp;p2)</td></tr>
<tr class="memdesc:a18c2db2ae4c3ac949b767f2d9ebbe43a"><td class="mdescLeft">&#160;</td><td class="mdescRight">pairwise contributions from the lowest and top layers to the energy  <a href="elc_8hpp.html#a18c2db2ae4c3ac949b767f2d9ebbe43a">More...</a><br /></td></tr>
<tr class="separator:a18c2db2ae4c3ac949b767f2d9ebbe43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f3933fe9746fe30f530174a0c9c0a97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a0f3933fe9746fe30f530174a0c9c0a97">ELC_P3M_dielectric_layers_force_contribution</a> (const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;pos1, const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;pos2, double q1q2)</td></tr>
<tr class="memdesc:a0f3933fe9746fe30f530174a0c9c0a97"><td class="mdescLeft">&#160;</td><td class="mdescRight">pairwise contributions from the lowest and top layers to the force  <a href="elc_8hpp.html#a0f3933fe9746fe30f530174a0c9c0a97">More...</a><br /></td></tr>
<tr class="separator:a0f3933fe9746fe30f530174a0c9c0a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d3b11984da56f04f6ce6e59c9bb6d9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#ab1d3b11984da56f04f6ce6e59c9bb6d9">ELC_P3M_dielectric_layers_energy_self</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:ab1d3b11984da56f04f6ce6e59c9bb6d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">self energies of top and bottom layers with their virtual images  <a href="elc_8hpp.html#ab1d3b11984da56f04f6ce6e59c9bb6d9">More...</a><br /></td></tr>
<tr class="separator:ab1d3b11984da56f04f6ce6e59c9bb6d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb5549c409435c89a4ffb165a4596ddc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#aeb5549c409435c89a4ffb165a4596ddc">ELC_P3M_self_forces</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:aeb5549c409435c89a4ffb165a4596ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">forces of particles in border layers with themselves  <a href="elc_8hpp.html#aeb5549c409435c89a4ffb165a4596ddc">More...</a><br /></td></tr>
<tr class="separator:aeb5549c409435c89a4ffb165a4596ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e29311b7418ec645a333cf27614399b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a5e29311b7418ec645a333cf27614399b">ELC_p3m_charge_assign_both</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a5e29311b7418ec645a333cf27614399b"><td class="mdescLeft">&#160;</td><td class="mdescRight">assign the additional, virtual charges, used only in <a class="el" href="energy_8cpp.html">energy.cpp</a>  <a href="elc_8hpp.html#a5e29311b7418ec645a333cf27614399b">More...</a><br /></td></tr>
<tr class="separator:a5e29311b7418ec645a333cf27614399b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442f0f4ecd7c14e860a22d142ad35045"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a442f0f4ecd7c14e860a22d142ad35045">ELC_p3m_charge_assign_image</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a442f0f4ecd7c14e860a22d142ad35045"><td class="mdescLeft">&#160;</td><td class="mdescRight">assign the additional, virtual charges, used only in <a class="el" href="energy_8cpp.html">energy.cpp</a>  <a href="elc_8hpp.html#a442f0f4ecd7c14e860a22d142ad35045">More...</a><br /></td></tr>
<tr class="separator:a442f0f4ecd7c14e860a22d142ad35045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a163521cd87103df7ca8a591e94d672"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a0a163521cd87103df7ca8a591e94d672">ELC_P3M_modify_p3m_sums_both</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a0a163521cd87103df7ca8a591e94d672"><td class="mdescLeft">&#160;</td><td class="mdescRight">take into account the virtual charges in the charge sums, used in <a class="el" href="energy_8cpp.html">energy.cpp</a>  <a href="elc_8hpp.html#a0a163521cd87103df7ca8a591e94d672">More...</a><br /></td></tr>
<tr class="separator:a0a163521cd87103df7ca8a591e94d672"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac34805ca65509a265199b92f763f3e22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#ac34805ca65509a265199b92f763f3e22">ELC_P3M_modify_p3m_sums_image</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:ac34805ca65509a265199b92f763f3e22"><td class="mdescLeft">&#160;</td><td class="mdescRight">take into account the virtual charges in the charge sums, used in <a class="el" href="energy_8cpp.html">energy.cpp</a>  <a href="elc_8hpp.html#ac34805ca65509a265199b92f763f3e22">More...</a><br /></td></tr>
<tr class="separator:ac34805ca65509a265199b92f763f3e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e7654d92bce700f1ac9c058f8f75fb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#a7e7654d92bce700f1ac9c058f8f75fb3">ELC_P3M_restore_p3m_sums</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a7e7654d92bce700f1ac9c058f8f75fb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">assign the additional, virtual charges, used only in <a class="el" href="energy_8cpp.html">energy.cpp</a>  <a href="elc_8hpp.html#a7e7654d92bce700f1ac9c058f8f75fb3">More...</a><br /></td></tr>
<tr class="separator:a7e7654d92bce700f1ac9c058f8f75fb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab6ed5dfe10e06e40bacd1db0b31163ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structELCParameters.html">ELCParameters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="elc_8hpp.html#ab6ed5dfe10e06e40bacd1db0b31163ee">elc_params</a></td></tr>
<tr class="separator:ab6ed5dfe10e06e40bacd1db0b31163ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ELC algorithm for long-range <a class="el" href="namespaceCoulomb.html">Coulomb</a> interactions. </p>
<p>Implementation of the ELC method for the calculation of the electrostatic interaction in two dimensional periodic systems. For details on the method see MMM in general. The ELC method works together with any three-dimensional method, for example <a class="el" href="p3m_8hpp.html">P3M</a>, with metallic boundary conditions. </p>

<p class="definition">Definition in file <a class="el" href="elc_8hpp_source.html">elc.hpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0bf4b36c5ac7b6b74ce5859e79af5640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bf4b36c5ac7b6b74ce5859e79af5640">&#9670;&nbsp;</a></span>ELC_add_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_add_force </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the force calculation </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l00848">848</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="elc_8cpp_source.html#l00206">add_dipole_force()</a>, <a class="el" href="elc_8cpp_source.html#l00787">add_PQ_force()</a>, <a class="el" href="elc_8cpp_source.html#l00449">add_z_force()</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="elc_8cpp_source.html#l00177">distribute()</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="elc_8hpp_source.html#l00052">ELCParameters::far_cut</a>, <a class="el" href="elc_8hpp_source.html#l00054">ELCParameters::far_cut2</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="elc_8cpp_source.html#l00080">partblk</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="elc_8cpp_source.html#l00135">prepare_sc_cache()</a>, <a class="el" href="elc_8cpp_source.html#l00655">setup_PQ()</a>, <a class="el" href="ParticleRange_8hpp_source.html#l00043">ParticleRange::size()</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, and <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="a97c568509320a43d99b56ab911394378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97c568509320a43d99b56ab911394378">&#9670;&nbsp;</a></span>ELC_energy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ELC_energy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the energy calculation </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l00905">905</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="elc_8cpp_source.html#l00273">dipole_energy()</a>, <a class="el" href="elc_8cpp_source.html#l00177">distribute()</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="elc_8hpp_source.html#l00052">ELCParameters::far_cut</a>, <a class="el" href="elc_8hpp_source.html#l00054">ELCParameters::far_cut2</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="elc_8cpp_source.html#l00080">partblk</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="elc_8cpp_source.html#l00634">PoQ_energy()</a>, <a class="el" href="elc_8cpp_source.html#l00826">PQ_energy()</a>, <a class="el" href="elc_8cpp_source.html#l00135">prepare_sc_cache()</a>, <a class="el" href="elc_8cpp_source.html#l00655">setup_PQ()</a>, <a class="el" href="ParticleRange_8hpp_source.html#l00043">ParticleRange::size()</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>, and <a class="el" href="elc_8cpp_source.html#l00370">z_energy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>.</p>

</div>
</div>
<a id="a3046e64e7bdbc5b933b8358414701199"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3046e64e7bdbc5b933b8358414701199">&#9670;&nbsp;</a></span>ELC_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize the ELC constants </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01040">1040</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="elc_8hpp_source.html#l00072">ELCParameters::dielectric_contrast_on</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="elc_8cpp_source.html#l00965">ELC_tune_far_cut()</a>, <a class="el" href="elc_8hpp_source.html#l00063">ELCParameters::far_calculated</a>, <a class="el" href="elc_8hpp_source.html#l00052">ELCParameters::far_cut</a>, <a class="el" href="elc_8hpp_source.html#l00054">ELCParameters::far_cut2</a>, <a class="el" href="elc_8hpp_source.html#l00058">ELCParameters::gap_size</a>, <a class="el" href="elc_8hpp_source.html#l00093">ELCParameters::h</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="Correlator_8cpp_source.html#l00048">anonymous_namespace{Correlator.cpp}::min()</a>, <a class="el" href="elc_8hpp_source.html#l00087">ELCParameters::minimal_dist</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="p3m-common_8hpp_source.html#l00146">P3MParameters::r_cut</a>, <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>, <a class="el" href="elc_8hpp_source.html#l00091">ELCParameters::space_box</a>, <a class="el" href="elc_8hpp_source.html#l00089">ELCParameters::space_layer</a>, and <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00234">Coulomb::init()</a>, <a class="el" href="coulomb_8cpp_source.html#l00210">Coulomb::on_boxl_change()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00179">on_coulomb_change()</a>.</p>

</div>
</div>
<a id="a5e29311b7418ec645a333cf27614399b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e29311b7418ec645a333cf27614399b">&#9670;&nbsp;</a></span>ELC_p3m_charge_assign_both()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_p3m_charge_assign_both </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>assign the additional, virtual charges, used only in <a class="el" href="energy_8cpp.html">energy.cpp</a> </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01171">1171</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="elc_8cpp_source.html#l01153">anonymous_namespace{elc.cpp}::assign_image_charge()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00129">P3MParameters::cao</a>, <a class="el" href="p3m_8hpp_source.html#l00078">p3m_data_struct::inter_weights</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m_8cpp_source.html#l00339">p3m_assign_charge()</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="p3m__interpolation_8hpp_source.html#l00125">p3m_interpolation_cache::reset()</a>, <a class="el" href="p3m_8hpp_source.html#l00067">p3m_data_struct::rs_mesh</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00093">P3MLocalMesh::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="a442f0f4ecd7c14e860a22d142ad35045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a442f0f4ecd7c14e860a22d142ad35045">&#9670;&nbsp;</a></span>ELC_p3m_charge_assign_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_p3m_charge_assign_image </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>assign the additional, virtual charges, used only in <a class="el" href="energy_8cpp.html">energy.cpp</a> </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01186">1186</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="elc_8cpp_source.html#l01153">anonymous_namespace{elc.cpp}::assign_image_charge()</a>, <a class="el" href="p3m_8hpp_source.html#l00065">p3m_data_struct::local_mesh</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="p3m_8hpp_source.html#l00067">p3m_data_struct::rs_mesh</a>, and <a class="el" href="p3m-common_8hpp_source.html#l00093">P3MLocalMesh::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>.</p>

</div>
</div>
<a id="a18c2db2ae4c3ac949b767f2d9ebbe43a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18c2db2ae4c3ac949b767f2d9ebbe43a">&#9670;&nbsp;</a></span>ELC_P3M_dielectric_layers_energy_contribution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ELC_P3M_dielectric_layers_energy_contribution </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParticle.html">Particle</a> const &amp;&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structParticle.html">Particle</a> const &amp;&#160;</td>
          <td class="paramname"><em>p2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pairwise contributions from the lowest and top layers to the energy </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01247">1247</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="elc_8cpp_source.html#l01224">ELC_P3M_dielectric_layers_energy_contribution()</a>, <a class="el" href="Particle_8hpp_source.html#l00260">ParticlePosition::p</a>, <a class="el" href="Particle_8hpp_source.html#l00404">Particle::p</a>, <a class="el" href="Particle_8hpp_source.html#l00118">ParticleProperties::q</a>, and <a class="el" href="Particle_8hpp_source.html#l00406">Particle::r</a>.</p>

</div>
</div>
<a id="ab1d3b11984da56f04f6ce6e59c9bb6d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d3b11984da56f04f6ce6e59c9bb6d9">&#9670;&nbsp;</a></span>ELC_P3M_dielectric_layers_energy_self()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ELC_P3M_dielectric_layers_energy_self </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>self energies of top and bottom layers with their virtual images </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01263">1263</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="elc_8cpp_source.html#l01224">ELC_P3M_dielectric_layers_energy_contribution()</a>, and <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>.</p>

</div>
</div>
<a id="a0f3933fe9746fe30f530174a0c9c0a97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f3933fe9746fe30f530174a0c9c0a97">&#9670;&nbsp;</a></span>ELC_P3M_dielectric_layers_force_contribution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> ELC_P3M_dielectric_layers_force_contribution </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;&#160;</td>
          <td class="paramname"><em>pos1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &amp;&#160;</td>
          <td class="paramname"><em>pos2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q1q2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pairwise contributions from the lowest and top layers to the force </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01200">1200</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="elc_8hpp_source.html#l00077">ELCParameters::delta_mid_bot</a>, <a class="el" href="elc_8hpp_source.html#l00075">ELCParameters::delta_mid_top</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00689">force</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00162">BoxGeometry::get_mi_vector()</a>, <a class="el" href="elc_8hpp_source.html#l00093">ELCParameters::h</a>, <a class="el" href="p3m_8hpp_source.html#l00171">p3m_add_pair_force()</a>, and <a class="el" href="elc_8hpp_source.html#l00089">ELCParameters::space_layer</a>.</p>

<p class="reference">Referenced by <a class="el" href="elc_8cpp_source.html#l01143">ELC_P3M_self_forces()</a>, and <a class="el" href="coulomb__inline_8hpp_source.html#l00075">Coulomb::pair_force()</a>.</p>

</div>
</div>
<a id="a0a163521cd87103df7ca8a591e94d672"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a163521cd87103df7ca8a591e94d672">&#9670;&nbsp;</a></span>ELC_P3M_modify_p3m_sums_both()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_P3M_modify_p3m_sums_both </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>take into account the virtual charges in the charge sums, used in <a class="el" href="energy_8cpp.html">energy.cpp</a> </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01277">1277</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="elc_8hpp_source.html#l00077">ELCParameters::delta_mid_bot</a>, <a class="el" href="elc_8hpp_source.html#l00075">ELCParameters::delta_mid_top</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="elc_8hpp_source.html#l00093">ELCParameters::h</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="elc_8hpp_source.html#l00089">ELCParameters::space_layer</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="p3m_8hpp_source.html#l00076">p3m_data_struct::square_sum_q</a>, <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>, and <a class="el" href="p3m_8hpp_source.html#l00072">p3m_data_struct::sum_qpart</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="ac34805ca65509a265199b92f763f3e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac34805ca65509a265199b92f763f3e22">&#9670;&nbsp;</a></span>ELC_P3M_modify_p3m_sums_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_P3M_modify_p3m_sums_image </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>take into account the virtual charges in the charge sums, used in <a class="el" href="energy_8cpp.html">energy.cpp</a> </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01313">1313</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="elc_8hpp_source.html#l00077">ELCParameters::delta_mid_bot</a>, <a class="el" href="elc_8hpp_source.html#l00075">ELCParameters::delta_mid_top</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="elc_8hpp_source.html#l00093">ELCParameters::h</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="elc_8hpp_source.html#l00089">ELCParameters::space_layer</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="p3m_8hpp_source.html#l00076">p3m_data_struct::square_sum_q</a>, <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>, and <a class="el" href="p3m_8hpp_source.html#l00072">p3m_data_struct::sum_qpart</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>.</p>

</div>
</div>
<a id="a7e7654d92bce700f1ac9c058f8f75fb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e7654d92bce700f1ac9c058f8f75fb3">&#9670;&nbsp;</a></span>ELC_P3M_restore_p3m_sums()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_P3M_restore_p3m_sums </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>assign the additional, virtual charges, used only in <a class="el" href="energy_8cpp.html">energy.cpp</a> </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01347">1347</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="p3m_8hpp_source.html#l00076">p3m_data_struct::square_sum_q</a>, <a class="el" href="p3m_8hpp_source.html#l00074">p3m_data_struct::sum_q2</a>, and <a class="el" href="p3m_8hpp_source.html#l00072">p3m_data_struct::sum_qpart</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="aeb5549c409435c89a4ffb165a4596ddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb5549c409435c89a4ffb165a4596ddc">&#9670;&nbsp;</a></span>ELC_P3M_self_forces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_P3M_self_forces </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>forces of particles in border layers with themselves </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01143">1143</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="elc_8cpp_source.html#l01200">ELC_P3M_dielectric_layers_force_contribution()</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, and <a class="el" href="coulomb_8hpp_source.html#l00050">Coulomb_parameters::prefactor</a>.</p>

<p class="reference">Referenced by <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="a241dba2d50ca461997dd693ebbee053e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a241dba2d50ca461997dd693ebbee053e">&#9670;&nbsp;</a></span>ELC_sanity_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_sanity_checks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structELCParameters.html">ELCParameters</a> const &amp;&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the ELC parameters </p>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01009">1009</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="steepest__descent_8cpp_source.html#l00044">params</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00097">BoxGeometry::periodic()</a>, <a class="el" href="config_8hpp_source.html#l00073">ROUND_ERROR_PREC</a>, and <a class="el" href="p3m_8hpp_source.html#l00076">p3m_data_struct::square_sum_q</a>.</p>

<p class="reference">Referenced by <a class="el" href="elc_8cpp_source.html#l01079">ELC_set_params()</a>, and <a class="el" href="coulomb_8cpp_source.html#l00087">Coulomb::sanity_checks()</a>.</p>

</div>
</div>
<a id="a66eb1e69b43e9483dc72282fd67af266"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66eb1e69b43e9483dc72282fd67af266">&#9670;&nbsp;</a></span>ELC_set_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ELC_set_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxPWerror</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>min_dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>far_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>neutralize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta_mid_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta_mid_bot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>const_pot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pot_diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set parameters for ELC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maxPWerror</td><td>Maximal allowed pairwise error for the potential and force. Note that this counts for the plain 1/r contribution alone, without the prefactor and the charge prefactor. </td></tr>
    <tr><td class="paramname">min_dist</td><td>Minimal distance of two charges for which the far formula is used. </td></tr>
    <tr><td class="paramname">far_cut</td><td>Cutoff of the exponential sum. If -1, the cutoff is automatically calculated using the error formulas. </td></tr>
    <tr><td class="paramname">neutralize</td><td>whether to add a neutralizing background. WARNING: This background exerts forces, which are dependent on the simulation box; especially the gap size enters into the value of the forces. </td></tr>
    <tr><td class="paramname">delta_mid_top</td><td>dielectric contrast in the upper part of the simulation cell. </td></tr>
    <tr><td class="paramname">delta_mid_bot</td><td>dielectric contrast in the lower part of the simulation cell. </td></tr>
    <tr><td class="paramname">const_pot</td><td>Flag whether a const. potential is applied. </td></tr>
    <tr><td class="paramname">pot_diff</td><td>Const. potential. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l01079">1079</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="coulomb_8cpp_source.html#l00055">coulomb</a>, <a class="el" href="coulomb_8hpp_source.html#l00040">COULOMB_ELC_P3M</a>, <a class="el" href="coulomb_8hpp_source.html#l00038">COULOMB_P3M</a>, <a class="el" href="elc_8cpp_source.html#l00053">elc_params</a>, <a class="el" href="elc_8cpp_source.html#l01009">ELC_sanity_checks()</a>, <a class="el" href="elc_8cpp_source.html#l00965">ELC_tune_far_cut()</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="elc_8hpp_source.html#l00063">ELCParameters::far_calculated</a>, <a class="el" href="elc_8hpp_source.html#l00052">ELCParameters::far_cut</a>, <a class="el" href="elc_8hpp_source.html#l00054">ELCParameters::far_cut2</a>, <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00695">h</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="Mmm1dgpuForce__cuda_8cu_source.html#l00063">maxPWerror</a>, <a class="el" href="coulomb_8hpp_source.html#l00056">Coulomb_parameters::method</a>, <a class="el" href="Correlator_8cpp_source.html#l00048">anonymous_namespace{Correlator.cpp}::min()</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, <a class="el" href="p3m_8cpp_source.html#l00074">p3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00074">P3M_EPSILON_METALLIC</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, and <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab6ed5dfe10e06e40bacd1db0b31163ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6ed5dfe10e06e40bacd1db0b31163ee">&#9670;&nbsp;</a></span>elc_params</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structELCParameters.html">ELCParameters</a> elc_params</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="elc_8cpp_source.html#l00053">53</a> of file <a class="el" href="elc_8cpp_source.html">elc.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="elc_8cpp_source.html#l00206">add_dipole_force()</a>, <a class="el" href="elc_8cpp_source.html#l00449">add_z_force()</a>, <a class="el" href="elc_8cpp_source.html#l01153">anonymous_namespace{elc.cpp}::assign_image_charge()</a>, <a class="el" href="coulomb_8cpp_source.html#l00400">Coulomb::bcast_coulomb_params()</a>, <a class="el" href="coulomb_8cpp_source.html#l00315">Coulomb::calc_energy_long_range()</a>, <a class="el" href="coulomb_8cpp_source.html#l00256">Coulomb::calc_long_range_force()</a>, <a class="el" href="elc_8cpp_source.html#l00187">check_gap_elc()</a>, <a class="el" href="coulomb_8cpp_source.html#l00113">Coulomb::cutoff()</a>, <a class="el" href="elc_8cpp_source.html#l00273">dipole_energy()</a>, <a class="el" href="elc_8cpp_source.html#l00848">ELC_add_force()</a>, <a class="el" href="elc_8cpp_source.html#l00905">ELC_energy()</a>, <a class="el" href="elc_8cpp_source.html#l01040">ELC_init()</a>, <a class="el" href="elc_8cpp_source.html#l01224">ELC_P3M_dielectric_layers_energy_contribution()</a>, <a class="el" href="elc_8cpp_source.html#l01200">ELC_P3M_dielectric_layers_force_contribution()</a>, <a class="el" href="elc_8cpp_source.html#l01277">ELC_P3M_modify_p3m_sums_both()</a>, <a class="el" href="elc_8cpp_source.html#l01313">ELC_P3M_modify_p3m_sums_image()</a>, <a class="el" href="elc_8cpp_source.html#l01079">ELC_set_params()</a>, <a class="el" href="coulomb_8cpp_source.html#l00367">Coulomb::icc_sanity_check()</a>, <a class="el" href="elc_8cpp_source.html#l00351">image_sum_b()</a>, <a class="el" href="elc_8cpp_source.html#l00360">image_sum_t()</a>, <a class="el" href="p3m_8cpp_source.html#l00167">p3m_init()</a>, <a class="el" href="p3m_8cpp_source.html#l00709">p3m_mc_time()</a>, <a class="el" href="coulomb__inline_8hpp_source.html#l00143">Coulomb::pair_energy()</a>, <a class="el" href="coulomb__inline_8hpp_source.html#l00075">Coulomb::pair_force()</a>, <a class="el" href="coulomb_8cpp_source.html#l00087">Coulomb::sanity_checks()</a>, <a class="el" href="elc_8cpp_source.html#l00508">setup_PoQ()</a>, <a class="el" href="elc_8cpp_source.html#l00655">setup_PQ()</a>, and <a class="el" href="elc_8cpp_source.html#l00370">z_energy()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_6b7c06b7a7a76c60d0c114007966a512.html">electrostatics_magnetostatics</a></li><li class="navelem"><a class="el" href="elc_8hpp.html">elc.hpp</a></li>
    <li class="footer">Generated on Tue Aug 31 2021 01:35:08 for ESPResSo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
