<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ESPResSo: mdlc_correction.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo
   </div>
   <div id="projectbrief">Extensible Simulation Package for Research on Soft Matter Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mdlc__correction_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mdlc_correction.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="mdlc__correction_8hpp_source.html">electrostatics_magnetostatics/mdlc_correction.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Particle_8hpp_source.html">Particle.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cells_8hpp_source.html">cells.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="communication_8hpp_source.html">communication.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="common_8hpp_source.html">electrostatics_magnetostatics/common.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dipole_8hpp_source.html">electrostatics_magnetostatics/dipole.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="p3m-dipolar_8hpp_source.html">electrostatics_magnetostatics/p3m-dipolar.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="errorhandling_8hpp_source.html">errorhandling.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="grid_8hpp_source.html">grid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="particle__data_8hpp_source.html">particle_data.hpp</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="constants_8hpp_source.html">utils/constants.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sqr_8hpp_source.html">utils/math/sqr.hpp</a>&gt;</code><br />
<code>#include &lt;boost/mpi.hpp&gt;</code><br />
<code>#include &lt;boost/mpi/collectives/all_reduce.hpp&gt;</code><br />
<code>#include &lt;boost/mpi/operations.hpp&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;numeric&gt;</code><br />
<code>#include &lt;stdexcept&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for mdlc_correction.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="mdlc__correction_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="mdlc__correction_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaeae445b5da6868d9d74664cd57e73e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#aaeae445b5da6868d9d74664cd57e73e4">check_gap_mdlc</a> (const <a class="el" href="structParticle.html">Particle</a> &amp;p)</td></tr>
<tr class="memdesc:aaeae445b5da6868d9d74664cd57e73e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a magnetic particle is in the forbidden gap region.  <a href="mdlc__correction_8cpp.html#aaeae445b5da6868d9d74664cd57e73e4">More...</a><br /></td></tr>
<tr class="separator:aaeae445b5da6868d9d74664cd57e73e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728487a4efbbcb31e263b2a5ff7f20ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#a728487a4efbbcb31e263b2a5ff7f20ce">calc_mu_max</a> ()</td></tr>
<tr class="memdesc:a728487a4efbbcb31e263b2a5ff7f20ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the maximal dipole moment in the system.  <a href="mdlc__correction_8cpp.html#a728487a4efbbcb31e263b2a5ff7f20ce">More...</a><br /></td></tr>
<tr class="separator:a728487a4efbbcb31e263b2a5ff7f20ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa06e5709880bbc2fe1b5efd62df6f9e0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#aa06e5709880bbc2fe1b5efd62df6f9e0">g1_DLC_dip</a> (double g, double x)</td></tr>
<tr class="separator:aa06e5709880bbc2fe1b5efd62df6f9e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6136bcc3965036125c963d955ddb55b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#af6136bcc3965036125c963d955ddb55b">g2_DLC_dip</a> (double g, double x)</td></tr>
<tr class="separator:af6136bcc3965036125c963d955ddb55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adce8f5d350e2586ec980ce75479f0be3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#adce8f5d350e2586ec980ce75479f0be3">calc_slab_dipole</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:adce8f5d350e2586ec980ce75479f0be3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the box magnetic dipole.  <a href="mdlc__correction_8cpp.html#adce8f5d350e2586ec980ce75479f0be3">More...</a><br /></td></tr>
<tr class="separator:adce8f5d350e2586ec980ce75479f0be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8ea96ba471626c2893810a980ae550"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#a0e8ea96ba471626c2893810a980ae550">get_DLC_dipolar</a> (int kcut, std::vector&lt; <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &gt; &amp;fs, std::vector&lt; <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &gt; &amp;ts, const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a0e8ea96ba471626c2893810a980ae550"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the dipolar DLC corrections for forces and torques.  <a href="mdlc__correction_8cpp.html#a0e8ea96ba471626c2893810a980ae550">More...</a><br /></td></tr>
<tr class="separator:a0e8ea96ba471626c2893810a980ae550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c7abd718dc4500948c1b92902a3b337"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#a0c7abd718dc4500948c1b92902a3b337">get_DLC_energy_dipolar</a> (int kcut, const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:a0c7abd718dc4500948c1b92902a3b337"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the dipolar DLC corrections Algorithm implemented accordingly to <a class="el" href="citelist.html#CITEREF_brodka04a">[8]</a>.  <a href="mdlc__correction_8cpp.html#a0c7abd718dc4500948c1b92902a3b337">More...</a><br /></td></tr>
<tr class="separator:a0c7abd718dc4500948c1b92902a3b337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac1eae1d40fce1ecde9f3b6e8e0a9d18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#aac1eae1d40fce1ecde9f3b6e8e0a9d18">add_mdlc_force_corrections</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:aac1eae1d40fce1ecde9f3b6e8e0a9d18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and add the terms needed to correct the 3D dipolar methods when we have a slab geometry.  <a href="mdlc__correction_8cpp.html#aac1eae1d40fce1ecde9f3b6e8e0a9d18">More...</a><br /></td></tr>
<tr class="separator:aac1eae1d40fce1ecde9f3b6e8e0a9d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae690b5e5067f1235358da692c7cabe7f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#ae690b5e5067f1235358da692c7cabe7f">add_mdlc_energy_corrections</a> (const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;particles)</td></tr>
<tr class="memdesc:ae690b5e5067f1235358da692c7cabe7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and add the terms needed to correct the energy of 3D dipolar methods when we have a slab geometry.  <a href="mdlc__correction_8cpp.html#ae690b5e5067f1235358da692c7cabe7f">More...</a><br /></td></tr>
<tr class="separator:ae690b5e5067f1235358da692c7cabe7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd5687be5dc3ca0fc30f7e09517c2f84"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#afd5687be5dc3ca0fc30f7e09517c2f84">mdlc_tune_far_cut</a> (<a class="el" href="structDLC__struct.html">DLC_struct</a> const &amp;<a class="el" href="steepest__descent_8cpp.html#a7c810f3a2b554c3abe0c472e66645420">params</a>)</td></tr>
<tr class="memdesc:afd5687be5dc3ca0fc30f7e09517c2f84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the cut-off in the DLC dipolar part to get a certain accuracy.  <a href="mdlc__correction_8cpp.html#afd5687be5dc3ca0fc30f7e09517c2f84">More...</a><br /></td></tr>
<tr class="separator:afd5687be5dc3ca0fc30f7e09517c2f84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b9e205e23ae425874c9fc0aedae886"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#a71b9e205e23ae425874c9fc0aedae886">mdlc_sanity_checks</a> ()</td></tr>
<tr class="separator:a71b9e205e23ae425874c9fc0aedae886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468dc91b544e4291bb58fccf966763b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#a468dc91b544e4291bb58fccf966763b1">mdlc_set_params</a> (double <a class="el" href="Mmm1dgpuForce__cuda_8cu.html#a1b210fdcda96c31426a7ddc6691d5175">maxPWerror</a>, double gap_size, double far_cut)</td></tr>
<tr class="separator:a468dc91b544e4291bb58fccf966763b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3916583a8e5cf64864d2b81464b8a0a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDLC__struct.html">DLC_struct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mdlc__correction_8cpp.html#a3916583a8e5cf64864d2b81464b8a0a4">dlc_params</a> = {1e100, 0., 0., false, 0.}</td></tr>
<tr class="separator:a3916583a8e5cf64864d2b81464b8a0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae690b5e5067f1235358da692c7cabe7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae690b5e5067f1235358da692c7cabe7f">&#9670;&nbsp;</a></span>add_mdlc_energy_corrections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double add_mdlc_energy_corrections </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and add the terms needed to correct the energy of 3D dipolar methods when we have a slab geometry. </p>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00380">380</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00098">calc_slab_dipole()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00056">check_gap_mdlc()</a>, <a class="el" href="dipole_8hpp_source.html#l00043">DIPOLAR_MDLC_P3M</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00052">dlc_params</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="mdlc__correction_8hpp_source.html#l00058">DLC_struct::far_cut</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00261">get_DLC_energy_dipolar()</a>, <a class="el" href="dipole_8hpp_source.html#l00064">Dipole_parameters::method</a>, <a class="el" href="p3m-common_8hpp_source.html#l00074">P3M_EPSILON_METALLIC</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="sqr_8hpp_source.html#l00026">Utils::sqr()</a>, <a class="el" href="communication_8cpp_source.html#l00062">this_node</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dipole_8cpp_source.html#l00220">Dipole::calc_energy_long_range()</a>.</p>

</div>
</div>
<a id="aac1eae1d40fce1ecde9f3b6e8e0a9d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1eae1d40fce1ecde9f3b6e8e0a9d18">&#9670;&nbsp;</a></span>add_mdlc_force_corrections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_mdlc_force_corrections </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and add the terms needed to correct the 3D dipolar methods when we have a slab geometry. </p>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00326">326</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00098">calc_slab_dipole()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00056">check_gap_mdlc()</a>, <a class="el" href="dipole_8hpp_source.html#l00043">DIPOLAR_MDLC_P3M</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00052">dlc_params</a>, <a class="el" href="p3m-dipolar_8cpp_source.html#l00086">dp3m</a>, <a class="el" href="p3m-common_8hpp_source.html#l00134">P3MParameters::epsilon</a>, <a class="el" href="mdlc__correction_8hpp_source.html#l00058">DLC_struct::far_cut</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00113">get_DLC_dipolar()</a>, <a class="el" href="dipole_8hpp_source.html#l00064">Dipole_parameters::method</a>, <a class="el" href="p3m-common_8hpp_source.html#l00074">P3M_EPSILON_METALLIC</a>, <a class="el" href="p3m-data__struct_8hpp_source.html#l00034">p3m_data_struct_base::params</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="dipole_8hpp_source.html#l00062">Dipole_parameters::prefactor</a>, <a class="el" href="ParticleRange_8hpp_source.html#l00043">ParticleRange::size()</a>, <a class="el" href="Vector_8hpp_source.html#l00348">Utils::vector_product()</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00134">BoxGeometry::volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="dipole_8cpp_source.html#l00170">Dipole::calc_long_range_force()</a>.</p>

</div>
</div>
<a id="a728487a4efbbcb31e263b2a5ff7f20ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728487a4efbbcb31e263b2a5ff7f20ce">&#9670;&nbsp;</a></span>calc_mu_max()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_mu_max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the maximal dipole moment in the system. </p>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00069">69</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="cells_8cpp_source.html#l00052">cell_structure</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, and <a class="el" href="CellStructure_8cpp_source.html#l00193">CellStructure::local_particles()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00433">mdlc_tune_far_cut()</a>.</p>

</div>
</div>
<a id="adce8f5d350e2586ec980ce75479f0be3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adce8f5d350e2586ec980ce75479f0be3">&#9670;&nbsp;</a></span>calc_slab_dipole()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> calc_slab_dipole </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the box magnetic dipole. </p>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00098">98</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, and <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00380">add_mdlc_energy_corrections()</a>, and <a class="el" href="mdlc__correction_8cpp_source.html#l00326">add_mdlc_force_corrections()</a>.</p>

</div>
</div>
<a id="aaeae445b5da6868d9d74664cd57e73e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeae445b5da6868d9d74664cd57e73e4">&#9670;&nbsp;</a></span>check_gap_mdlc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void check_gap_mdlc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structParticle.html">Particle</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if a magnetic particle is in the forbidden gap region. </p>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00056">56</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="Particle_8hpp_source.html#l00130">ParticleProperties::dipm</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00052">dlc_params</a>, <a class="el" href="mdlc__correction_8hpp_source.html#l00072">DLC_struct::h</a>, <a class="el" href="Particle_8hpp_source.html#l00089">ParticleProperties::identity</a>, <a class="el" href="Particle_8hpp_source.html#l00260">ParticlePosition::p</a>, <a class="el" href="Particle_8hpp_source.html#l00404">Particle::p</a>, <a class="el" href="Particle_8hpp_source.html#l00406">Particle::r</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00087">runtimeErrorMsg</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00380">add_mdlc_energy_corrections()</a>, and <a class="el" href="mdlc__correction_8cpp_source.html#l00326">add_mdlc_force_corrections()</a>.</p>

</div>
</div>
<a id="aa06e5709880bbc2fe1b5efd62df6f9e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa06e5709880bbc2fe1b5efd62df6f9e0">&#9670;&nbsp;</a></span>g1_DLC_dip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double g1_DLC_dip </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00083">83</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="lb-d3q19_8hpp_source.html#l00038">D3Q19::c</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00433">mdlc_tune_far_cut()</a>.</p>

</div>
</div>
<a id="af6136bcc3965036125c963d955ddb55b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6136bcc3965036125c963d955ddb55b">&#9670;&nbsp;</a></span>g2_DLC_dip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double g2_DLC_dip </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00091">91</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00433">mdlc_tune_far_cut()</a>.</p>

</div>
</div>
<a id="a0e8ea96ba471626c2893810a980ae550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e8ea96ba471626c2893810a980ae550">&#9670;&nbsp;</a></span>get_DLC_dipolar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_DLC_dipolar </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kcut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespaceUtils.html#a27516c3f3251a3e74c3db670856dfd95">Utils::Vector3d</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the dipolar DLC corrections for forces and torques. </p>
<p>Algorithm implemented accordingly to <a class="el" href="citelist.html#CITEREF_brodka04a">[8]</a>. </p>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00113">113</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00704">b</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="lb-d3q19_8hpp_source.html#l00038">D3Q19::c</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00695">f</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="ParticleRange_8hpp_source.html#l00043">ParticleRange::size()</a>, <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>, and <a class="el" href="Vector_8hpp_source.html#l00348">Utils::vector_product()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00326">add_mdlc_force_corrections()</a>.</p>

</div>
</div>
<a id="a0c7abd718dc4500948c1b92902a3b337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c7abd718dc4500948c1b92902a3b337">&#9670;&nbsp;</a></span>get_DLC_energy_dipolar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_DLC_energy_dipolar </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kcut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classParticleRange.html">ParticleRange</a> &amp;&#160;</td>
          <td class="paramname"><em>particles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the dipolar DLC corrections Algorithm implemented accordingly to <a class="el" href="citelist.html#CITEREF_brodka04a">[8]</a>. </p>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00261">261</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00704">b</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="lb-d3q19_8hpp_source.html#l00038">D3Q19::c</a>, <a class="el" href="communication_8cpp_source.html#l00047">comm_cart</a>, <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00695">f</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00112">BoxGeometry::length_inv()</a>, <a class="el" href="CellStructure_8hpp_source.html#l00081">Cells::particles()</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>, and <a class="el" href="communication_8cpp_source.html#l00062">this_node</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00380">add_mdlc_energy_corrections()</a>.</p>

</div>
</div>
<a id="a71b9e205e23ae425874c9fc0aedae886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71b9e205e23ae425874c9fc0aedae886">&#9670;&nbsp;</a></span>mdlc_sanity_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mdlc_sanity_checks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00469">469</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, and <a class="el" href="BoxGeometry_8hpp_source.html#l00097">BoxGeometry::periodic()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00475">mdlc_set_params()</a>, and <a class="el" href="dipole_8cpp_source.html#l00067">Dipole::nonbonded_sanity_check()</a>.</p>

</div>
</div>
<a id="a468dc91b544e4291bb58fccf966763b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a468dc91b544e4291bb58fccf966763b1">&#9670;&nbsp;</a></span>mdlc_set_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mdlc_set_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxPWerror</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gap_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>far_cut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00475">475</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="dipole_8hpp_source.html#l00047">DIPOLAR_DS</a>, <a class="el" href="dipole_8hpp_source.html#l00049">DIPOLAR_MDLC_DS</a>, <a class="el" href="dipole_8hpp_source.html#l00043">DIPOLAR_MDLC_P3M</a>, <a class="el" href="dipole_8hpp_source.html#l00041">DIPOLAR_P3M</a>, <a class="el" href="dipole_8cpp_source.html#l00050">dipole</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00052">dlc_params</a>, <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00695">h</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="Mmm1dgpuForce__cuda_8cu_source.html#l00063">maxPWerror</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00469">mdlc_sanity_checks()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00433">mdlc_tune_far_cut()</a>, <a class="el" href="dipole_8hpp_source.html#l00064">Dipole_parameters::method</a>, <a class="el" href="common_8cpp_source.html#l00052">mpi_bcast_coulomb_params()</a>, and <a class="el" href="dipole_8cpp_source.html#l00296">Dipole::set_method_local()</a>.</p>

</div>
</div>
<a id="afd5687be5dc3ca0fc30f7e09517c2f84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd5687be5dc3ca0fc30f7e09517c2f84">&#9670;&nbsp;</a></span>mdlc_tune_far_cut()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mdlc_tune_far_cut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDLC__struct.html">DLC_struct</a> const &amp;&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the cut-off in the DLC dipolar part to get a certain accuracy. </p>
<p>We assume particles to have all the same value of the dipolar momentum modulus, which is taken as the largest value of mu inside the system. If we assume the gap has a width <code>gap_size</code> (within which there is no particles): <code>Lz = h + gap_size</code></p>
<p>BE CAREFUL:</p><ol type="1">
<li>We assume the short distance for the slab to be in the <em>z</em>-direction</li>
<li>You must also tune the other 3D method to the same accuracy, otherwise it makes no sense to have an accurate result for DLC-dipolar. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00433">433</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">References <a class="el" href="abs_8hpp_source.html#l00032">Utils::abs()</a>, <a class="el" href="grid_8cpp_source.html#l00046">box_geo</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00069">calc_mu_max()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00083">g1_DLC_dip()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00091">g2_DLC_dip()</a>, <a class="el" href="particle__data_8cpp_source.html#l01311">get_n_part()</a>, <a class="el" href="DipolarBarnesHut__cuda_8cu_source.html#l00695">h</a>, <a class="el" href="BoxGeometry_8hpp_source.html#l00106">BoxGeometry::length()</a>, <a class="el" href="MpiCallbacks_8hpp_source.html#l00080">Communication::Result::master_rank</a>, <a class="el" href="communication_8hpp_source.html#l00095">mpi_call()</a>, <a class="el" href="steepest__descent_8cpp_source.html#l00044">params</a>, <a class="el" href="constants_8hpp_source.html#l00036">Utils::pi()</a>, and <a class="el" href="Vector_8hpp_source.html#l00337">Utils::sqrt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00475">mdlc_set_params()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a3916583a8e5cf64864d2b81464b8a0a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3916583a8e5cf64864d2b81464b8a0a4">&#9670;&nbsp;</a></span>dlc_params</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDLC__struct.html">DLC_struct</a> dlc_params = {1e100, 0., 0., false, 0.}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mdlc__correction_8cpp_source.html#l00052">52</a> of file <a class="el" href="mdlc__correction_8cpp_source.html">mdlc_correction.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="mdlc__correction_8cpp_source.html#l00380">add_mdlc_energy_corrections()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00326">add_mdlc_force_corrections()</a>, <a class="el" href="dipole_8cpp_source.html#l00269">Dipole::bcast_params()</a>, <a class="el" href="mdlc__correction_8cpp_source.html#l00056">check_gap_mdlc()</a>, and <a class="el" href="mdlc__correction_8cpp_source.html#l00475">mdlc_set_params()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_6b7c06b7a7a76c60d0c114007966a512.html">electrostatics_magnetostatics</a></li><li class="navelem"><a class="el" href="mdlc__correction_8cpp.html">mdlc_correction.cpp</a></li>
    <li class="footer">Generated on Tue Aug 31 2021 01:35:09 for ESPResSo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
